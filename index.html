<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Atom to Univers</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Audiowide&family=Orbitron:wght@400;600;700&family=Inter:wght@400;500;600&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="styles/main.css" />
</head>
<body class="theme-dark">
  <header class="app-header">
    <div class="header-main">
      <button
        class="brand brand-button brand--locked"
        id="brandPortal"
        type="button"
        disabled
        aria-disabled="true"
      >
        Atom2Univers
      </button>
      <nav class="nav-menu" aria-label="Navigation principale">
        <button class="nav-button active" data-target="game">Atoms</button>
        <button class="nav-button" data-target="shop">Shop</button>
        <button class="nav-button" data-target="gacha">Gacha</button>
        <button class="nav-button" data-target="tableau">Table</button>
        <button class="nav-button" data-target="fusion">Fusion</button>
        <button class="nav-button" data-target="info">Infos</button>
        <button class="nav-button" data-target="goals">Goals</button>
        <button class="nav-button" data-target="bigbang" id="navBigBangButton" hidden aria-hidden="true">Big Bang</button>
        <button class="nav-button" data-target="options">Options</button>
      </nav>
    </div>
    <div class="status-bar" aria-live="polite">
      <div class="status-side status-side--left">
        <div class="status-item status-item--left">
          <span class="status-label">APC</span>
          <div class="status-value-group status-value-group--left">
            <span class="status-value" id="statusApc">1</span>
            <span class="status-frenzy-indicator" id="statusApcFrenzy" hidden></span>
          </div>
        </div>
        <div class="status-item status-item--crit" aria-live="polite">
          <div class="status-crit-display" id="statusCrit" role="status" aria-atomic="true" hidden>
            <span class="status-crit-value" id="statusCritValue">+0</span>
          </div>
        </div>
      </div>
      <div class="status-item status-item--center" aria-label="Total d'atomes">
        <span class="status-value status-value--main" id="statusAtoms">0</span>
      </div>
      <div class="status-side status-side--right">
        <div class="status-item status-item--right">
          <span class="status-label">APS</span>
          <div class="status-value-group status-value-group--aps">
            <span class="status-value" id="statusAps">0</span>
            <span class="status-frenzy-indicator" id="statusApsFrenzy" hidden></span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main id="pageContainer">
    <section id="game" class="page active page--void" aria-label="Chambre de création atomique">
      <div class="starfield" aria-hidden="true"></div>

      <button class="atom-button" id="atomButton" aria-label="Créer des atomes" type="button">
        <span class="atom-visual">
          <img src="Assets/Image/Atom.png" alt="Illustration d'un atome vibrant" class="atom-image" draggable="false" />
        </span>
      </button>
      <div class="ticket-layer" id="ticketLayer" aria-hidden="true"></div>
      <div class="frenzy-layer" id="frenzyLayer" aria-hidden="true"></div>
    </section>

    <section id="shop" class="page" aria-labelledby="shop-title">
      <h2 id="shop-title" class="visually-hidden">Boutique quantique</h2>
      <div class="shop-list" id="shopList" role="list"></div>
    </section>

    <section id="gacha" class="page page--gacha" aria-labelledby="gacha-title">
      <h2 id="gacha-title" class="visually-hidden">Portail de tirage cosmique</h2>
      <div class="gacha-ticket-counter" id="gachaTicketCounter" aria-live="polite">
        <button
          class="gacha-ticket-mode"
          id="gachaTicketModeButton"
          type="button"
          aria-label="Basculer le mode de tirage (actuel : Tirage x1)"
        >
          <img
            src="Assets/Image/ministar.png"
            alt=""
            class="gacha-ticket-counter__icon"
            aria-hidden="true"
            draggable="false"
          />
          <span class="gacha-ticket-mode__label" id="gachaTicketModeLabel">Tirage x1</span>
        </button>
        <span class="gacha-ticket-counter__value" id="gachaTicketValue">0 ticket</span>
      </div>
      <button
        class="gacha-sun-button"
        id="gachaSunButton"
        type="button"
        aria-label="Déclencher un tirage cosmique"
        aria-describedby="gachaTicketCounter"
      >
        <img src="Assets/Image/Sun.png" alt="Soleil cosmique" draggable="false" />
      </button>
      <div
        class="gacha-animation-layer"
        id="gachaAnimation"
        aria-hidden="true"
        hidden
        tabindex="0"
      >
        <div class="gacha-confetti-layer" id="gachaAnimationConfetti" aria-hidden="true"></div>
        <div class="gacha-overlay" aria-hidden="true"></div>
        <div class="gacha-result" id="gachaResult" role="status" aria-live="assertive"></div>
        <p class="gacha-continue-hint" id="gachaContinueHint">Cliquer pour continuer</p>
      </div>
    </section>

    <section id="arcade" class="page page--arcade" aria-label="Particules" hidden>
      <header class="arcade-header" aria-label="Navigation du jeu Particules">
        <button class="arcade-header__brand brand brand-button" id="arcadeReturnButton" type="button">
          Atom2Univers
        </button>
        <div class="arcade-header__title" aria-live="polite">
          <h2 class="arcade-header__game-title">Particules</h2>
          <p class="arcade-header__subtitle">
            Canalisez les particules quantiques pour gagner des tickets de tirage.
          </p>
        </div>
        <div class="arcade-header__status" aria-live="polite">
          <span class="arcade-header__status-label">Tickets</span>
          <span class="arcade-header__status-value" id="arcadeTicketValue">0 ticket</span>
        </div>
      </header>

      <div class="arcade-content">
        <div class="arcade-hud" role="status" aria-live="polite">
          <div class="arcade-hud__item">
            <span class="arcade-hud__label">Niveau</span>
            <span class="arcade-hud__value" id="arcadeLevelValue">1</span>
          </div>
          <div class="arcade-hud__item">
            <span class="arcade-hud__label">Vies</span>
            <span class="arcade-hud__value" id="arcadeLivesValue">3</span>
          </div>
          <div class="arcade-hud__item">
            <span class="arcade-hud__label">Score</span>
            <span class="arcade-hud__value" id="arcadeScoreValue">0</span>
          </div>
        </div>

        <div class="arcade-stage">
          <canvas
            id="arcadeGameCanvas"
            class="arcade-stage__canvas"
            aria-label="Zone de jeu Particules"
            role="presentation"
          ></canvas>
          <div class="arcade-overlay" id="arcadeOverlay" role="dialog" aria-modal="false" hidden>
            <div class="arcade-overlay__content">
              <p class="arcade-overlay__message" id="arcadeOverlayMessage">
                Touchez ou cliquez la raquette pour guider la particule et détruire les briques quantiques.
              </p>
              <button type="button" class="arcade-overlay__button" id="arcadeOverlayButton">Commencer</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="tableau" class="page page--table" aria-label="Tableau périodique des éléments">
      <div class="periodic-table-wrapper" role="presentation">
        <div class="periodic-table" id="periodicTable" role="grid" aria-label="Tableau périodique des éléments">
          <aside class="element-info-panel" id="elementInfoPanel" aria-live="polite">
            <p class="element-info-panel__placeholder" id="elementInfoPlaceholder">
              Sélectionnez un élément pour afficher ses propriétés.
            </p>
            <div class="element-info-panel__content" id="elementInfoContent" hidden>
              <header class="element-info-panel__header">
                <span class="element-info-panel__number" id="elementInfoNumber"></span>
                <div class="element-info-panel__identity">
                  <div class="element-info-panel__symbol-row">
                    <span class="element-info-panel__symbol" id="elementInfoSymbol"></span>
                    <span class="element-info-panel__owned-count" id="elementInfoOwnedCount"></span>
                  </div>
                  <span class="element-info-panel__name" id="elementInfoName"></span>
                </div>
              </header>
              <dl class="element-info-panel__details">
                <div class="element-info-panel__row">
                  <dt>Famille</dt>
                  <dd id="elementInfoCategory" class="element-info-panel__value element-info-panel__category"></dd>
                </div>
                <div class="element-info-panel__row">
                  <dt>Collection</dt>
                  <dd id="elementInfoCollection" class="element-info-panel__value element-info-panel__collection"></dd>
                </div>
              </dl>
            </div>
          </aside>
          <!-- Le tableau est généré dynamiquement par app.js -->
        </div>
      </div>
    </section>

    <section id="fusion" class="page page--fusion" aria-labelledby="fusion-title">
      <h2 id="fusion-title" class="fusion-title">Chambre de fusion moléculaire</h2>
      <p class="fusion-intro">
        Combinez vos éléments pour tenter de former des molécules inédites. Les ingrédients sont prélevés
        sur vos stocks actuels et la réussite n’est jamais garantie.
      </p>
      <div class="fusion-list" id="fusionList" role="list"></div>
      <div class="fusion-log" id="fusionLog" role="status" aria-live="polite"></div>
    </section>

    <section id="info" class="page" aria-labelledby="info-title">
      <h2 id="info-title" class="visually-hidden">Informations de progression</h2>
      <div class="info-grid">
        <article class="info-card info-card--production" aria-labelledby="info-aps-title">
          <header class="info-card__header">
            <h3 id="info-aps-title">Production automatique (APS)</h3>
            <p class="info-card__subtitle">Synthèse par seconde</p>
          </header>
          <ul id="infoApsBreakdown" class="production-breakdown" aria-label="Détail du calcul APS"></ul>
        </article>

        <article class="info-card info-card--production" aria-labelledby="info-apc-title">
          <header class="info-card__header">
            <h3 id="info-apc-title">Production manuelle (APC)</h3>
            <p class="info-card__subtitle">Atomes par clic</p>
          </header>
          <ul id="infoApcBreakdown" class="production-breakdown" aria-label="Détail du calcul APC"></ul>
        </article>

        <article class="info-card info-card--stats info-card--progression" aria-labelledby="info-progress-title">
          <header class="info-card__header">
            <h3 id="info-progress-title">Progression</h3>
            <p class="info-card__subtitle">Session &amp; globale</p>
          </header>
          <div class="info-progress-grid" role="group" aria-labelledby="info-progress-title">
            <section class="info-progress-block" aria-labelledby="info-session-title">
              <h4 id="info-session-title">Session</h4>
              <dl class="info-metrics">
                <div class="info-metrics__row">
                  <dt>Atomes gagnés</dt>
                  <dd id="infoSessionAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Clics manuels</dt>
                  <dd id="infoSessionClicks">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes via APC</dt>
                  <dd id="infoSessionApcAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes via APS</dt>
                  <dd id="infoSessionApsAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes hors ligne</dt>
                  <dd id="infoSessionOfflineAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Durée en ligne</dt>
                  <dd id="infoSessionDuration">0s</dd>
                </div>
              </dl>
            </section>
            <section class="info-progress-block" aria-labelledby="info-global-title">
              <h4 id="info-global-title">Globale</h4>
              <dl class="info-metrics">
                <div class="info-metrics__row">
                  <dt>Atomes gagnés</dt>
                  <dd id="infoGlobalAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Clics manuels</dt>
                  <dd id="infoGlobalClicks">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes via APC</dt>
                  <dd id="infoGlobalApcAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes via APS</dt>
                  <dd id="infoGlobalApsAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Atomes hors ligne</dt>
                  <dd id="infoGlobalOfflineAtoms">0</dd>
                </div>
                <div class="info-metrics__row">
                  <dt>Durée de jeu</dt>
                  <dd id="infoGlobalDuration">0s</dd>
                </div>
              </dl>
            </section>
          </div>
        </article>

        <article class="info-card info-card--bonuses" aria-labelledby="info-shop-bonus-title">
          <header class="info-card__header">
            <h3 id="info-shop-bonus-title">Bonus boutique</h3>
            <p class="info-card__subtitle">Effets cumulés du magasin</p>
          </header>
          <div
            id="infoShopBonuses"
            class="element-bonus-list shop-bonus-list"
            role="list"
            aria-live="polite"
          ></div>
        </article>

        <article class="info-card info-card--bonuses" aria-labelledby="info-bonus-title">
          <header class="info-card__header">
            <h3 id="info-bonus-title">Bonus éléments</h3>
            <p class="info-card__subtitle" id="infoBonusSubtitle">
              Commun cosmique · Essentiel planétaire · Forge stellaire · Singularité minérale · Mythe quantique · Irréel
            </p>
          </header>
          <div id="infoElementBonuses" class="element-bonus-list" role="list" aria-live="polite"></div>
        </article>
      </div>
    </section>

    <section id="goals" class="page" aria-labelledby="goals-title">
      <h2 id="goals-title">Objectifs &amp; trophées</h2>
      <p class="section-intro">Surveillez vos succès galactiques et débloquez des bonus permanents.</p>
      <p class="goals-empty" id="goalsEmpty" hidden>Aucun trophée complété pour le moment. Terminez des objectifs pour les afficher ici.</p>
      <div class="goals-list" id="goalsList" role="list"></div>
    </section>

    <section id="bigbang" class="page page--bigbang" aria-labelledby="bigbang-title">
      <div class="bigbang-content">
        <h2 id="bigbang-title">Big Bang</h2>
        <p class="bigbang-description">A venir</p>
      </div>
    </section>

    <section id="options" class="page" aria-labelledby="options-title">
      <h2 id="options-title">Options</h2>
      <div class="options-grid">
        <div class="option-card">
          <h3>Thème</h3>
          <div class="option-row">
            <label for="themeSelect">Apparence</label>
            <select id="themeSelect">
              <option value="dark">Sombre</option>
              <option value="light">Clair</option>
              <option value="neon">Néon</option>
            </select>
          </div>
        </div>
        <div class="option-card">
          <h3>Musique</h3>
          <div class="option-row">
            <label for="musicTrackSelect">Piste en lecture</label>
            <select id="musicTrackSelect" disabled>
              <option>Chargement...</option>
            </select>
          </div>
          <div class="option-row">
            <label for="musicVolumeSlider">Volume</label>
            <input type="range" id="musicVolumeSlider" min="0" max="100" step="1" value="50" />
          </div>
          <p class="option-note" id="musicTrackStatus">
            La musique démarre automatiquement après votre première interaction.
          </p>
        </div>
        <div class="option-card" id="bigBangOptionCard" hidden>
          <h3>Big Bang</h3>
          <div class="option-row">
            <label for="bigBangNavToggle">Afficher le bouton</label>
            <input type="checkbox" id="bigBangNavToggle" />
          </div>
          <p class="option-note">Débloqué en atteignant l’échelle : univers observable.</p>
        </div>
      </div>
      <div class="options-reset">
        <button id="resetButton" class="danger">Réinitialiser</button>
      </div>
    </section>
  </main>

  <div class="devkit-overlay" id="devkitOverlay" hidden aria-hidden="true">
    <div class="devkit-panel" id="devkitPanel" role="dialog" aria-modal="true" aria-labelledby="devkitTitle" tabindex="-1">
      <header class="devkit-panel__header">
        <h2 id="devkitTitle">DevKit quantique</h2>
        <button type="button" class="devkit-panel__close" id="devkitCloseButton" aria-label="Fermer le DevKit">×</button>
      </header>
      <p class="devkit-panel__intro">Outils de triche pour expérimentations rapides. Les changements sont immédiats.</p>
      <div class="devkit-grid">
        <section class="devkit-section" aria-labelledby="devkitResourcesTitle">
          <h3 id="devkitResourcesTitle">Ressources</h3>
          <form id="devkitAtomsForm" class="devkit-form">
            <label for="devkitAtomsInput">Donner des atomes</label>
            <div class="devkit-form__controls">
              <input type="text" id="devkitAtomsInput" inputmode="decimal" autocomplete="off" placeholder="ex : 1e9" />
              <button type="submit" class="primary">Ajouter</button>
            </div>
          </form>
          <form id="devkitAutoForm" class="devkit-form">
            <label for="devkitAutoInput">Augmenter les APS plats</label>
            <div class="devkit-form__controls">
              <input type="text" id="devkitAutoInput" inputmode="decimal" autocomplete="off" placeholder="ex : 250000" />
              <button type="submit" class="primary">Augmenter</button>
            </div>
          </form>
          <div class="devkit-status-row">
            <span>Bonus APS actuel :</span>
            <strong id="devkitAutoStatus">0</strong>
            <button type="button" id="devkitResetAuto" class="devkit-link">Réinitialiser</button>
          </div>
          <form id="devkitTicketsForm" class="devkit-form">
            <label for="devkitTicketsInput">Donner des tickets de tirage</label>
            <div class="devkit-form__controls">
              <input type="number" id="devkitTicketsInput" min="1" step="1" autocomplete="off" placeholder="ex : 50" />
              <button type="submit" class="primary">Ajouter</button>
            </div>
          </form>
        </section>
        <section class="devkit-section" aria-labelledby="devkitUnlockTitle">
          <h3 id="devkitUnlockTitle">Déblocages instantanés</h3>
          <button type="button" class="devkit-action" id="devkitUnlockTrophies">Débloquer tous les succès</button>
          <button type="button" class="devkit-action" id="devkitUnlockElements">Débloquer tout le tableau périodique</button>
        </section>
        <section class="devkit-section" aria-labelledby="devkitModesTitle">
          <h3 id="devkitModesTitle">Modes persistants</h3>
          <button type="button" class="devkit-toggle" id="devkitToggleShop" data-active="false" aria-pressed="false">Magasin gratuit : désactivé</button>
          <button type="button" class="devkit-toggle" id="devkitToggleGacha" data-active="false" aria-pressed="false">Tirages gratuits : désactivés</button>
          <p class="devkit-note">Les modes restent actifs tant que la session est ouverte (raccourci F9).</p>
        </section>
      </div>
      <footer class="devkit-panel__footer">
        <p>Appuyez sur <kbd>F9</kbd> pour ouvrir ou fermer le DevKit.</p>
      </footer>
    </div>
  </div>

  <script src="config/config.js"></script>
  <script src="scripts/utils.js"></script>
  <script src="scripts/app.js"></script>
</body>
</html>
