:root {
  color-scheme: dark light;
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --bg-dark: #080b13;
  --bg-light: #f6f7fb;
  --bg-neon: radial-gradient(circle at top, #101030 0%, #040409 100%);
  --fg-dark: #f4f7ff;
  --fg-light: #0d101a;
  --fg-neon: #e4e7ff;
  --accent: #4c8dff;
  --accent-strong: #6ebdff;
  --danger: #ff4c6a;
  --card-dark: rgba(255,255,255,0.06);
  --card-light: rgba(12,16,32,0.06);
  --card-neon: rgba(90,110,255,0.08);
  --max-width: min(1100px, 92vw);
  --transition: 0.2s ease;
  --header-padding-y: clamp(0.56rem, 0.896vw, 0.784rem);
  --header-padding-x: clamp(1.2rem, 2vw, 2.4rem);
  --status-padding-y: clamp(0.315rem, 0.51vw, 0.45rem);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  background: var(--bg-dark);
  color: var(--fg-dark);
  display: flex;
  flex-direction: column;
  transition: background 0.4s ease, color 0.4s ease;
}

body.theme-light {
  background: var(--bg-light);
  color: var(--fg-light);
}

body.theme-neon {
  background: var(--bg-neon);
  color: var(--fg-neon);
}

.app-header {
  position: sticky;
  top: 0;
  z-index: 20;
  background: rgba(8, 11, 19, 0.72);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  display: flex;
  flex-direction: column;
  gap: 0;
  user-select: none;
}

body.view-arcade {
  background: radial-gradient(140% 160% at 50% 0%, #1a1e48 0%, #070918 55%, #01020a 100%);
}

body.view-arcade .app-header {
  display: none;
}

body.view-arcade main {
  width: 100%;
  justify-content: center;
}

body.theme-light .app-header {
  background: rgba(246, 247, 251, 0.78);
  border-bottom-color: rgba(12, 16, 32, 0.08);
}

body.theme-neon .app-header {
  background: rgba(10, 10, 40, 0.8);
  border-bottom-color: rgba(90, 120, 255, 0.22);
}

.header-main {
  padding: var(--header-padding-y) var(--header-padding-x);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1.2rem;
}

.brand {
  font-family: 'Audiowide', 'Orbitron', sans-serif;
  font-size: clamp(1.162rem, 1.89vw, 1.68rem);
  letter-spacing: 0.14em;
  text-transform: uppercase;
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  white-space: nowrap;
}

.brand-button {
  appearance: none;
  border: none;
  background: none;
  padding: 0;
  margin: 0;
  color: inherit;
  font: inherit;
  letter-spacing: inherit;
  text-transform: inherit;
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  cursor: default;
  transition: color 0.3s ease, text-shadow 0.3s ease, transform 0.3s ease;
}

.brand-button:focus-visible {
  outline: 2px solid rgba(255, 255, 255, 0.65);
  outline-offset: 4px;
}

body.theme-light .brand-button:focus-visible {
  outline-color: rgba(40, 48, 96, 0.65);
}

.brand--locked {
  opacity: 0.7;
  pointer-events: none;
}

.brand--portal-ready {
  --brand-portal-glow: rgba(255, 224, 154, 0.55);
  background: linear-gradient(120deg, #ffd166, #ff8ba7, #70d6ff, #caffbf, #bdb2ff, #ffd166);
  background-size: 240% 240%;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  animation: statusMainSheen 8s linear infinite;
  cursor: pointer;
  text-shadow: 0 0.45rem 1.4rem var(--brand-portal-glow);
}

.brand--portal-ready:hover,
.brand--portal-ready:focus-visible {
  transform: translateY(-1px);
}

body.theme-light .brand--portal-ready {
  --brand-portal-glow: rgba(58, 47, 126, 0.32);
}

body.theme-neon .brand--portal-ready {
  --brand-portal-glow: rgba(140, 240, 255, 0.65);
}

.brand--pulse {
  animation: brandPortalPulse 1.4s ease-in-out forwards;
}

@keyframes brandPortalPulse {
  0% {
    text-shadow: 0 0 0 rgba(255, 255, 255, 0);
    transform: scale(1);
  }
  35% {
    text-shadow: 0 0.75rem 1.9rem var(--brand-portal-glow, rgba(255, 224, 154, 0.55));
    transform: scale(1.05);
  }
  70% {
    text-shadow: 0 0.5rem 1.5rem rgba(255, 255, 255, 0.28);
    transform: scale(1.02);
  }
  100% {
    text-shadow: 0 0.45rem 1.4rem var(--brand-portal-glow, rgba(255, 224, 154, 0.55));
    transform: scale(1);
  }
}

.status-bar {
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
  align-items: center;
  padding: var(--status-padding-y) var(--header-padding-x);
  gap: clamp(0.4rem, 0.8vw, 0.8rem);
  border-top: 1px solid rgba(255, 255, 255, 0.08);
}

body.view-metaux .status-bar {
  display: none;
}

.status-item {
  display: flex;
  flex-direction: column;
  gap: 0.12rem;
}

.status-side {
  display: inline-flex;
  align-items: center;
  gap: clamp(0.55rem, 1vw, 0.95rem);
}

.status-side--left {
  justify-self: flex-start;
}

.status-side--right {
  justify-self: flex-end;
}

.status-item--left {
  text-align: left;
  align-items: flex-start;
}

.status-item--center {
  text-align: center;
  align-items: center;
  justify-self: center;
}

.status-item--crit {
  text-align: left;
  align-items: flex-start;
  justify-self: flex-start;
  min-width: 0;
}

.status-crit-display {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0;
  padding: clamp(0.18rem, 0.5vw, 0.35rem) clamp(0.55rem, 1vw, 0.8rem);
  border-radius: 999px;
  background: linear-gradient(120deg, rgba(255, 118, 45, 0.22), rgba(255, 182, 82, 0.32));
  box-shadow: 0 0.4rem 1.4rem rgba(255, 126, 45, 0.18);
  color: #ffdcbc;
  font-family: 'Orbitron', monospace;
  font-size: clamp(1.066rem, 1.95vw, 1.43rem);
  font-weight: 600;
  letter-spacing: 0.04em;
  text-shadow: 0 0.16rem 0.45rem rgba(0, 0, 0, 0.35);
  opacity: 0;
  transform: translateY(-38%) scale(0.92);
  transition: opacity 0.34s ease, transform 0.34s cubic-bezier(0.35, 0.94, 0.52, 1.25);
  min-width: 0;
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
}

.status-crit-display::before {
  content: '';
  position: absolute;
  inset: -35% -40% auto -40%;
  height: 120%;
  background: radial-gradient(65% 90% at 50% 45%, rgba(255, 190, 90, 0.6), rgba(255, 120, 40, 0));
  opacity: 0.8;
  filter: blur(10px);
  transform: translateY(-18%);
  pointer-events: none;
}

.status-crit-display.is-active {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.status-crit-display.is-fading {
  opacity: 0;
  transform: translateY(12%) scale(0.9);
}

.status-crit-value {
  position: relative;
  display: inline-flex;
  align-items: flex-end;
  gap: 0.18rem;
  line-height: 1;
  min-width: 0;
  white-space: nowrap;
}

.status-crit-value--smash {
  animation: crit-value-smash 0.58s cubic-bezier(0.17, 0.86, 0.36, 1.1);
}

.status-crit-display.is-fading .status-crit-value--smash {
  animation: none;
}

@keyframes crit-value-smash {
  0% {
    transform: translateY(-135%) scaleX(0.55) scaleY(1.7);
    filter: drop-shadow(0 0.65rem 1.2rem rgba(255, 170, 60, 0.7));
  }
  58% {
    transform: translateY(8%) scaleX(1.18) scaleY(0.58);
    filter: drop-shadow(0 0.35rem 0.75rem rgba(255, 120, 35, 0.55));
  }
  78% {
    transform: translateY(-6%) scaleX(0.9) scaleY(1.25);
  }
  100% {
    transform: translateY(0) scaleX(1) scaleY(1);
    filter: drop-shadow(0 0.12rem 0.28rem rgba(0, 0, 0, 0.45));
  }
}

.status-item--right {
  text-align: right;
  align-items: flex-end;
}

.status-value-group {
  display: inline-flex;
  align-items: center;
  gap: clamp(0.25rem, 0.6vw, 0.45rem);
  flex-wrap: wrap;
}

.status-value-group--left {
  justify-content: flex-start;
  text-align: left;
}

.status-value-group--aps {
  flex-direction: row-reverse;
}

.status-label {
  font-size: clamp(0.55rem, 0.88vw, 0.7rem);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  opacity: 0.72;
}

.status-value {
  font-family: 'Orbitron', monospace;
  font-size: clamp(0.92rem, 1.6vw, 1.2rem);
}

.status-frenzy-indicator {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(0.55rem, 0.9vw, 0.72rem);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: #9cf3ff;
  padding: 0.14rem 0.5rem;
  border-radius: 999px;
  border: 1px solid rgba(140, 220, 255, 0.45);
  background: linear-gradient(120deg, rgba(90, 170, 255, 0.18), rgba(20, 45, 80, 0.42));
  text-shadow: 0 0 6px rgba(120, 220, 255, 0.75), 0 0 18px rgba(60, 150, 255, 0.55);
  box-shadow: 0 0 12px rgba(70, 170, 255, 0.18);
  display: inline-flex;
  align-items: center;
  gap: 0.22rem;
  animation: frenzyPulse 1.4s ease-in-out infinite;
  white-space: nowrap;
}

.status-frenzy-indicator[hidden] {
  display: none;
}

body.theme-light .status-frenzy-indicator {
  color: #0e3760;
  border-color: rgba(0, 110, 190, 0.32);
  background: linear-gradient(120deg, rgba(160, 210, 255, 0.35), rgba(220, 240, 255, 0.65));
  text-shadow: 0 0 10px rgba(90, 180, 255, 0.55);
}

body.theme-neon .status-frenzy-indicator {
  color: #bffaff;
  border-color: rgba(120, 255, 255, 0.5);
  background: linear-gradient(140deg, rgba(120, 255, 255, 0.24), rgba(120, 120, 255, 0.32));
  text-shadow: 0 0 12px rgba(140, 255, 255, 0.9);
}

@keyframes frenzyPulse {
  0%, 100% {
    box-shadow: 0 0 10px rgba(80, 190, 255, 0.35), 0 0 24px rgba(40, 120, 255, 0.2);
    filter: saturate(1.1);
  }
  50% {
    box-shadow: 0 0 18px rgba(120, 230, 255, 0.55), 0 0 40px rgba(20, 180, 255, 0.3);
    filter: saturate(1.4);
  }
}

.status-value--main {
  font-size: clamp(1.65rem, 3vw, 2.35rem);
  background: linear-gradient(120deg, #ffd166, #ff8ba7, #70d6ff, #caffbf, #bdb2ff, #ffd166);
  background-size: 240% 240%;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  animation: statusMainSheen 8s linear infinite;
  text-shadow: 0 0 12px rgba(255, 255, 255, 0.35);
}

@keyframes statusMainSheen {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

body.theme-light .status-bar {
  border-top-color: rgba(12, 16, 32, 0.08);
}

body.theme-neon .status-bar {
  border-top-color: rgba(90, 120, 255, 0.22);
}

.nav-menu {
  display: flex;
  gap: 0.6rem;
  flex-wrap: wrap;
  justify-content: center;
}

.nav-button {
  background: rgba(255, 255, 255, 0.08);
  border: none;
  color: inherit;
  font-family: 'Audiowide', 'Orbitron', sans-serif;
  font-size: 0.9rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  padding: 0.31rem 0.84rem;
  border-radius: 999px;
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition), color var(--transition);
}

.nav-button:hover,
.nav-button:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.32);
}

.nav-button.active {
  background: var(--accent);
  color: #05070c;
}

body.theme-light .nav-button {
  background: rgba(12,16,32,0.08);
}

body.theme-light .nav-button.active {
  color: #f7f9ff;
}

body.theme-neon .nav-button {
  background: rgba(120, 140, 255, 0.18);
}

body.theme-neon .nav-button.active {
  background: linear-gradient(120deg, #7affff, #9f7aff);
  color: #04030c;
}

main {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: stretch;
  min-height: 0;
}

.page { 
  display: none;
  width: 100%;
  max-width: var(--max-width);
  padding: clamp(1.6rem, 4vw, 2.6rem);
  flex: 1 1 auto;
  min-height: 0;
}

.page.active {
  display: block;
}

.page--arcade {
  display: none;
  width: 100%;
  max-width: 100%;
  margin: 0 auto;
  --arcade-padding-x: clamp(0.8rem, 2vw, 1.2rem);
  --arcade-padding-top: clamp(0rem, 0.2vw, 0.15rem);
  --arcade-padding-bottom: clamp(1rem, 2.8vw, 1.6rem);
  --arcade-stage-spacing: clamp(0.25rem, 1.4vh, 0.8rem);
  --arcade-header-height: clamp(2.9rem, 5.5vh, 3.8rem);
  --arcade-vertical-offset: calc(
    var(--arcade-padding-top) + var(--arcade-padding-bottom) + var(--arcade-stage-spacing) * 2 + var(--arcade-header-height)
  );
  padding: var(--arcade-padding-top) var(--arcade-padding-x) var(--arcade-padding-bottom);
}

.page--arcade.active {
  display: flex;
  flex-direction: column;
  gap: clamp(0.2rem, 0.9vw, 0.6rem);
  align-items: center;
  min-height: 100vh;
}

.arcade-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(0.5rem, 1.4vw, 1rem);
  min-height: var(--arcade-header-height);
  padding: clamp(0.4rem, 1.1vw, 0.7rem) clamp(0.7rem, 1.6vw, 1rem);
  border-radius: 1rem;
  background: linear-gradient(140deg, rgba(18, 24, 56, 0.78), rgba(8, 12, 34, 0.82));
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 12px 28px rgba(6, 10, 32, 0.32);
}

.arcade-header__brand {
  flex-shrink: 0;
  padding-inline: clamp(0.78rem, 1.6vw, 1.3rem);
  padding-block: clamp(0.46rem, 1.05vw, 0.78rem);
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  background: rgba(255, 255, 255, 0.04);
  cursor: pointer;
  font-size: clamp(0.95rem, 2.1vw, 1.3rem);
  letter-spacing: 0.1em;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.arcade-header__status-group {
  display: flex;
  align-items: stretch;
  gap: clamp(0.5rem, 1.1vw, 0.85rem);
}

.arcade-header__brand:hover,
.arcade-header__brand:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 12px 24px rgba(12, 16, 40, 0.35);
}

.arcade-header__title {
  display: flex;
  flex-direction: column;
  gap: clamp(0.25rem, 0.8vw, 0.5rem);
  flex: 1 1 auto;
  min-width: 0;
}

.arcade-header__game-title {
  margin: 0;
  font-family: 'Audiowide', 'Orbitron', sans-serif;
  font-size: clamp(1.4rem, 3.1vw, 2rem);
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.arcade-header__subtitle {
  margin: 0;
  font-size: clamp(0.8rem, 1.4vw, 1.05rem);
  color: rgba(230, 234, 255, 0.78);
  max-width: 52ch;
}

.arcade-header__status {
  appearance: none;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(16, 22, 48, 0.6);
  color: inherit;
  font: inherit;
  font-family: 'Orbitron', 'Inter', sans-serif;
  display: inline-flex;
  align-items: baseline;
  gap: clamp(0.45rem, 1vw, 0.85rem);
  padding: clamp(0.55rem, 1.1vw, 0.95rem) clamp(0.95rem, 1.6vw, 1.35rem);
  border-radius: 1.2rem;
  cursor: pointer;
  letter-spacing: 0.08em;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.arcade-header__status--info {
  cursor: default;
  pointer-events: none;
  background: rgba(40, 56, 112, 0.35);
  border-color: rgba(255, 255, 255, 0.14);
}

.arcade-header__status--info .arcade-header__status-value {
  font-size: clamp(0.95rem, 1.8vw, 1.3rem);
}

.arcade-header__status:hover,
.arcade-header__status:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 14px 32px rgba(12, 18, 44, 0.45);
}

.arcade-header__status:focus-visible {
  outline: 2px solid rgba(255, 255, 255, 0.7);
  outline-offset: 3px;
}

.arcade-header__status-label {
  font-size: clamp(0.66rem, 1vw, 0.85rem);
  opacity: 0.78;
}

.arcade-header__status-value {
  font-size: clamp(1.1rem, 2.1vw, 1.52rem);
  font-weight: 700;
  letter-spacing: 0.08em;
}

body.theme-light .arcade-header {
  background: linear-gradient(140deg, rgba(248, 250, 255, 0.92), rgba(210, 220, 255, 0.9));
  border-color: rgba(40, 52, 120, 0.18);
  box-shadow: 0 20px 40px rgba(28, 38, 74, 0.16);
}

body.theme-light .arcade-header__brand {
  border-color: rgba(40, 52, 120, 0.18);
  background: rgba(12, 16, 32, 0.06);
}

body.theme-light .arcade-header__subtitle {
  color: rgba(18, 24, 52, 0.72);
}

body.theme-light .arcade-header__status {
  background: rgba(240, 244, 255, 0.82);
  border-color: rgba(48, 64, 120, 0.16);
  color: inherit;
}

body.theme-light .arcade-header__status--info {
  background: rgba(224, 230, 255, 0.88);
  border-color: rgba(48, 64, 120, 0.2);
}

body.theme-light .arcade-header__status:focus-visible {
  outline-color: rgba(40, 48, 96, 0.7);
}

body.theme-neon .arcade-header {
  background: linear-gradient(140deg, rgba(32, 28, 112, 0.88), rgba(10, 22, 88, 0.9));
  border-color: rgba(120, 150, 255, 0.28);
  box-shadow: 0 24px 48px rgba(14, 18, 72, 0.55);
}

body.theme-neon .arcade-header__subtitle {
  color: rgba(190, 200, 255, 0.85);
}

body.theme-neon .arcade-header__status {
  background: rgba(38, 32, 110, 0.8);
  border-color: rgba(160, 190, 255, 0.32);
}

body.theme-neon .arcade-header__status--info {
  background: rgba(54, 46, 150, 0.82);
  border-color: rgba(160, 190, 255, 0.4);
}

.arcade-content {
  display: flex;
  align-items: stretch;
  justify-content: center;
  gap: clamp(0.75rem, 2vw, 1.5rem);
  flex: 1 1 auto;
  width: 100%;
  padding-block: var(--arcade-stage-spacing);
}

.arcade-stage {
  position: relative;
  flex: 0 1 auto;
  width: min(
    max(520px, calc((100vh - var(--arcade-vertical-offset)) * 1.6)),
    calc(100vw - var(--arcade-padding-x) * 2),
    1400px
  );
  max-height: max(0px, calc(100vh - var(--arcade-vertical-offset)));
  aspect-ratio: 16 / 10;
  border-radius: 1.4rem;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: radial-gradient(circle at top, rgba(28, 36, 88, 0.65), rgba(8, 12, 34, 0.95));
  overflow: hidden;
  box-shadow: 0 32px 68px rgba(6, 8, 28, 0.55);
  transform: translateZ(0);
  will-change: transform;
}

.arcade-stage--pulse {
  animation: arcade-stage-pulse 420ms cubic-bezier(0.22, 0.7, 0.3, 1) forwards;
}

@keyframes arcade-stage-pulse {
  0% {
    transform: translateZ(0) scale(1);
  }
  38% {
    transform: translateZ(0) scale(var(--arcade-pulse-scale, 1.04));
  }
  100% {
    transform: translateZ(0) scale(1);
  }
}

.arcade-stage {
  align-self: center;
}

.arcade-legend {
  flex: 0 0 clamp(120px, 13vw, 180px);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: clamp(0.75rem, 1.6vw, 1.1rem);
  padding: clamp(0.75rem, 1.4vw, 1rem);
  border-radius: 1.2rem;
  border: 1px solid rgba(120, 190, 255, 0.2);
  background: linear-gradient(180deg, rgba(18, 26, 64, 0.85), rgba(10, 16, 44, 0.92));
  box-shadow: inset 0 0 0 1px rgba(120, 190, 255, 0.1);
  color: rgba(220, 232, 255, 0.95);
  text-align: left;
}

.arcade-legend__title {
  margin: 0;
  font-size: clamp(0.8rem, 1.2vw, 0.95rem);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(175, 205, 255, 0.9);
}

.arcade-legend__list {
  margin: 0;
  display: grid;
  gap: clamp(0.4rem, 1.1vw, 0.8rem);
  padding: 0;
}

.arcade-legend__item {
  display: grid;
  grid-template-columns: auto 1fr;
  column-gap: clamp(0.35rem, 0.8vw, 0.6rem);
  align-items: baseline;
}

.arcade-legend__symbol {
  font-size: clamp(0.95rem, 1.8vw, 1.3rem);
  font-weight: 600;
  color: rgba(255, 255, 255, 0.98);
}

.arcade-legend__description {
  margin: 0;
  font-size: clamp(0.68rem, 1vw, 0.82rem);
  color: rgba(200, 215, 240, 0.92);
}

@media (max-width: 960px) {
  .arcade-stage {
    width: min(
      calc(100vw - var(--arcade-padding-x) * 2),
      max(360px, calc((100vh - var(--arcade-vertical-offset)) * 1.6))
    );
  }
  .arcade-content {
    flex-direction: column;
    align-items: center;
  }
  .arcade-legend {
    width: min(100%, 420px);
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    gap: clamp(0.5rem, 2.5vw, 1rem);
    border-radius: 1rem;
  }
  .arcade-legend__list {
    width: 100%;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: clamp(0.45rem, 2vw, 0.9rem);
  }
  .arcade-legend__item {
    grid-template-columns: auto;
    text-align: center;
  }
}

@media (max-width: 640px) {
  .arcade-stage {
    width: calc(100vw - var(--arcade-padding-x) * 2);
    max-height: calc((100vw - var(--arcade-padding-x) * 2) / 1.6);
  }
  .arcade-legend__symbol {
    font-size: clamp(0.85rem, 4vw, 1.1rem);
  }
  .arcade-legend__description {
    font-size: clamp(0.64rem, 3.5vw, 0.78rem);
  }
}

.arcade-stage::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, rgba(120, 190, 255, 0.12), transparent 65%);
  pointer-events: none;
}

.arcade-stage__canvas {
  width: 100%;
  height: 100%;
  display: block;
  position: relative;
  z-index: 1;
  touch-action: none;
  cursor: pointer;
}

.arcade-particle-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
  overflow: hidden;
}

.arcade-shockwave {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(
    circle at var(--shockwave-x, 50%) var(--shockwave-y, 50%),
    rgba(210, 245, 255, 0.85),
    rgba(120, 200, 255, 0.18) 45%,
    rgba(20, 40, 80, 0) 75%
  );
  mix-blend-mode: screen;
  opacity: 0;
  transform-origin: var(--shockwave-x, 50%) var(--shockwave-y, 50%);
  animation: arcade-shockwave 520ms ease-out forwards;
  filter: saturate(1.2);
}

@keyframes arcade-shockwave {
  0% {
    opacity: var(--shockwave-opacity, 0.8);
    transform: scale(0.55);
  }
  45% {
    opacity: calc(var(--shockwave-opacity, 0.8) * 0.65);
  }
  100% {
    opacity: 0;
    transform: scale(var(--shockwave-scale, 1.35));
  }
}

.arcade-ball-ghost {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.85), rgba(160, 220, 255, 0.18) 55%, rgba(80, 140, 255, 0));
  mix-blend-mode: screen;
  box-shadow: 0 0 var(--arcade-ball-ghost-blur, 12px) rgba(140, 210, 255, 0.65);
  opacity: 0.7;
  animation: arcade-ball-ghost-fade 260ms ease-out forwards;
}

.arcade-ball-ghost::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: radial-gradient(circle, rgba(200, 240, 255, 0.25), rgba(100, 180, 255, 0));
  filter: blur(2px);
  opacity: 0.6;
}

.arcade-ball-ghost::before {
  content: '';
  position: absolute;
  inset: 15%;
  border-radius: inherit;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0));
  filter: blur(1px);
  opacity: 0.7;
}

.arcade-particle {
  position: absolute;
  width: 5px;
  height: 5px;
  opacity: 0;
  border-radius: 1px;
  background: linear-gradient(135deg, hsla(210, 95%, 75%, 0.95), hsla(265, 80%, 60%, 0.5));
  mix-blend-mode: screen;
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0) scale(var(--arcade-particle-scale-start, 1));
  animation: arcade-particle-burst var(--arcade-particle-duration, 1.5s)
    cubic-bezier(0.18, 0.58, 0.28, 1) forwards;
}

@keyframes arcade-particle-burst {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(var(--arcade-particle-scale-start, 1))
      rotate(var(--arcade-particle-rotation, 35deg));
  }
  45% {
    opacity: 1;
    transform: translate3d(
        var(--arcade-particle-burst-x, 0px),
        var(--arcade-particle-burst-y, -80px),
        0
      )
      scale(var(--arcade-particle-scale-peak, 1.15))
      rotate(var(--arcade-particle-rotation, 35deg));
  }
  70% {
    opacity: 0.9;
    transform: translate3d(
        var(--arcade-particle-burst-x, 0px),
        var(--arcade-particle-burst-y, -80px),
        0
      )
      scale(
        calc(
          (var(--arcade-particle-scale-peak, 1.15) + var(--arcade-particle-scale-end, 0.45)) / 2
        )
      )
      rotate(var(--arcade-particle-rotation, 35deg));
  }
  100% {
    opacity: 0;
    transform: translate3d(
        var(--arcade-particle-burst-x, 0px),
        var(--arcade-particle-burst-y, -80px),
        0
      )
      scale(var(--arcade-particle-scale-end, 0.45))
      rotate(var(--arcade-particle-rotation, 35deg));
  }
}

@keyframes arcade-ball-ghost-fade {
  0% {
    opacity: 0.55;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(1.35);
  }
}

.arcade-stage__hud {
  position: absolute;
  bottom: clamp(0.4rem, 1.6vw, 1.2rem);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(0.4rem, 0.9vw, 0.75rem);
  z-index: 2;
  pointer-events: none;
  color: rgba(230, 240, 255, 0.92);
}

.arcade-stage__hud .arcade-hud {
  display: none;
}

.arcade-hud__combo {
  margin: 0;
  min-height: 1.2em;
  font-size: clamp(0.72rem, 1.2vw, 0.95rem);
  letter-spacing: 0.08em;
  text-align: center;
  text-shadow: 0 0 12px rgba(160, 220, 255, 0.45);
}

body.theme-light .arcade-stage__hud {
  color: rgba(14, 22, 48, 0.92);
}

body.theme-light .arcade-hud__combo {
  text-shadow: 0 0 12px rgba(48, 86, 148, 0.32);
}

body.theme-neon .arcade-hud__combo {
  text-shadow: 0 0 14px rgba(180, 120, 255, 0.45);
}

.arcade-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(1.2rem, 4vw, 2.4rem);
  background: rgba(4, 6, 18, 0.78);
  backdrop-filter: blur(10px);
  z-index: 2;
}

.arcade-overlay__content {
  display: flex;
  flex-direction: column;
  gap: clamp(0.8rem, 2vw, 1.2rem);
  max-width: min(420px, 86vw);
  text-align: center;
}

.arcade-overlay__message {
  margin: 0;
  font-size: clamp(0.9rem, 1.6vw, 1.2rem);
  line-height: 1.5;
}

.arcade-overlay__button {
  align-self: center;
  padding: clamp(0.55rem, 1.2vw, 0.85rem) clamp(1.4rem, 3vw, 2.2rem);
  border-radius: 999px;
  border: none;
  font-family: 'Orbitron', 'Inter', sans-serif;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-size: clamp(0.68rem, 1vw, 0.82rem);
  cursor: pointer;
  color: #02040c;
  background: linear-gradient(120deg, #6ee7ff, #67d6ff 45%, #cba4ff);
  box-shadow: 0 14px 28px rgba(80, 210, 255, 0.45);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.arcade-overlay__button:hover,
.arcade-overlay__button:focus-visible {
  transform: translateY(-2px);
  box-shadow: 0 18px 34px rgba(120, 220, 255, 0.55);
}

.arcade-overlay[hidden] {
  display: none;
}


.page--bigbang {
  display: none;
}

.page--bigbang.active {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.bigbang-content {
  display: flex;
  flex-direction: column;
  gap: clamp(0.8rem, 2vw, 1.4rem);
  padding: clamp(2rem, 5vw, 3rem);
  border-radius: 1.8rem;
  background: linear-gradient(160deg, rgba(32, 44, 96, 0.8), rgba(12, 16, 40, 0.92));
  box-shadow: 0 28px 52px rgba(4, 10, 28, 0.6);
  border: 1px solid rgba(120, 150, 255, 0.22);
  max-width: min(520px, 90vw);
}

body.theme-light .bigbang-content {
  background: linear-gradient(160deg, rgba(240, 244, 255, 0.92), rgba(202, 214, 255, 0.94));
  border-color: rgba(118, 148, 255, 0.28);
  box-shadow: 0 24px 40px rgba(18, 24, 40, 0.16);
}

body.theme-neon .bigbang-content {
  background: linear-gradient(160deg, rgba(52, 24, 120, 0.88), rgba(10, 40, 120, 0.9));
  border-color: rgba(152, 120, 255, 0.38);
  box-shadow: 0 32px 54px rgba(32, 18, 92, 0.68);
}

#bigbang-title {
  margin: 0;
  font-family: 'Audiowide', 'Orbitron', sans-serif;
  font-size: clamp(1.8rem, 4.5vw, 2.4rem);
  letter-spacing: 0.14em;
  text-transform: uppercase;
}

.bigbang-description {
  margin: 0;
  font-size: clamp(1.1rem, 2.5vw, 1.35rem);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(228, 231, 255, 0.85);
}

body.theme-light .bigbang-description {
  color: rgba(28, 34, 56, 0.72);
}

body.theme-neon .bigbang-description {
  color: rgba(190, 200, 255, 0.9);
}

.page--fusion {
  display: none;
}

.page--fusion.active {
  display: flex;
  flex-direction: column;
  gap: clamp(1.2rem, 3vw, 1.8rem);
}

.fusion-title {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(1.4rem, 3vw, 1.85rem);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin: 0;
}

.fusion-intro {
  margin: 0;
  color: rgba(238, 241, 255, 0.75);
  max-width: 60ch;
  line-height: 1.5;
}

body.theme-light .fusion-intro {
  color: rgba(18, 24, 40, 0.7);
}

.fusion-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: clamp(1rem, 2.8vw, 1.6rem);
}

.fusion-card {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 0.9rem;
  padding: clamp(1.1rem, 3vw, 1.5rem);
  border-radius: 1.15rem;
  background: linear-gradient(135deg, rgba(34, 44, 78, 0.78), rgba(16, 20, 44, 0.88));
  box-shadow: 0 18px 32px rgba(4, 8, 20, 0.55);
  border: 1px solid rgba(130, 170, 255, 0.12);
}

body.theme-light .fusion-card {
  background: linear-gradient(135deg, rgba(248, 250, 255, 0.96), rgba(214, 224, 255, 0.92));
  border-color: rgba(108, 140, 240, 0.18);
  box-shadow: 0 16px 26px rgba(18, 24, 40, 0.15);
}

body.theme-neon .fusion-card {
  background: linear-gradient(135deg, rgba(48, 36, 84, 0.92), rgba(16, 28, 84, 0.92));
  border-color: rgba(122, 120, 255, 0.3);
  box-shadow: 0 22px 36px rgba(40, 24, 96, 0.6);
}

.fusion-card__header {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.fusion-card__title {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
}

.fusion-card__chance {
  margin: 0;
  font-size: 0.85rem;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: rgba(238, 241, 255, 0.66);
}

body.theme-light .fusion-card__chance {
  color: rgba(24, 32, 58, 0.62);
}

.fusion-card__requirements {
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.fusion-card__description {
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.5;
  color: rgba(238, 241, 255, 0.72);
}

body.theme-light .fusion-card__description {
  color: rgba(24, 32, 58, 0.68);
}

.fusion-requirement {
  display: flex;
  align-items: center;
  gap: 0.7rem;
  font-size: 0.95rem;
}

.fusion-requirement__symbol {
  font-family: 'Orbitron', sans-serif;
  letter-spacing: 0.08em;
  font-size: 0.85rem;
  text-transform: uppercase;
  padding: 0.15rem 0.45rem;
  border-radius: 999px;
  background: rgba(130, 170, 255, 0.2);
  color: rgba(238, 241, 255, 0.85);
}

body.theme-light .fusion-requirement__symbol {
  background: rgba(108, 140, 240, 0.2);
  color: rgba(18, 24, 40, 0.75);
}

.fusion-requirement__count {
  margin-left: auto;
  font-variant-numeric: tabular-nums;
}

.fusion-requirement__availability {
  font-size: 0.8rem;
  color: rgba(238, 241, 255, 0.6);
}

body.theme-light .fusion-requirement__availability {
  color: rgba(24, 32, 58, 0.58);
}

.fusion-card__stats,
.fusion-card__bonus {
  margin: 0;
  font-size: 0.85rem;
  color: rgba(238, 241, 255, 0.72);
}

body.theme-light .fusion-card__stats,
body.theme-light .fusion-card__bonus {
  color: rgba(24, 32, 58, 0.68);
}

.fusion-card__actions {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.fusion-card__status {
  flex: 1 1 auto;
  text-align: right;
}

.fusion-card__button {
  flex: 0 0 auto;
  padding: 0.55rem 1.1rem;
  border-radius: 0.9rem;
  border: 0;
  background: linear-gradient(120deg, #5079ff, #6ebeff);
  color: #f4f7ff;
  font-weight: 600;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: transform 0.25s ease, box-shadow 0.25s ease, filter 0.25s ease;
}

.fusion-card__button:disabled {
  cursor: not-allowed;
  opacity: 0.6;
  filter: grayscale(0.4);
  box-shadow: none;
}

.fusion-card__button:not(:disabled):hover,
.fusion-card__button:not(:disabled):focus-visible {
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(72, 118, 255, 0.35);
}

.fusion-card__button:focus-visible {
  outline: 2px solid rgba(255, 255, 255, 0.7);
  outline-offset: 2px;
}

.fusion-card__feedback {
  font-size: 0.82rem;
  color: rgba(238, 241, 255, 0.65);
}

.fusion-card__total {
  font-weight: 500;
}

body.theme-light .fusion-card__feedback {
  color: rgba(24, 32, 58, 0.6);
}

.fusion-empty {
  margin: 0;
  padding: clamp(1.4rem, 3vw, 1.8rem);
  border-radius: 1rem;
  background: rgba(26, 34, 68, 0.55);
  color: rgba(238, 241, 255, 0.75);
  text-align: center;
  font-size: 0.95rem;
  box-shadow: inset 0 0 0 1px rgba(130, 170, 255, 0.15);
}

body.theme-light .fusion-empty {
  background: rgba(230, 236, 255, 0.85);
  color: rgba(24, 32, 58, 0.7);
  box-shadow: inset 0 0 0 1px rgba(108, 140, 240, 0.2);
}

.fusion-log {
  min-height: 2rem;
  padding: 0.9rem 1.2rem;
  border-radius: 0.9rem;
  background: rgba(32, 44, 88, 0.35);
  color: rgba(238, 241, 255, 0.82);
  font-size: 0.9rem;
  box-shadow: 0 10px 22px rgba(4, 8, 20, 0.45);
  border: 1px solid rgba(130, 170, 255, 0.18);
}

.fusion-log.fusion-log--success {
  border-color: rgba(120, 255, 200, 0.45);
  background: rgba(32, 84, 72, 0.35);
}

.fusion-log.fusion-log--failure {
  border-color: rgba(255, 140, 120, 0.45);
  background: rgba(84, 40, 40, 0.35);
}

body.theme-light .fusion-log {
  background: rgba(234, 238, 255, 0.85);
  border-color: rgba(108, 140, 240, 0.25);
  color: rgba(24, 32, 58, 0.75);
  box-shadow: 0 12px 24px rgba(18, 24, 40, 0.12);
}

body.theme-light .fusion-log.fusion-log--success {
  border-color: rgba(100, 210, 180, 0.5);
  background: rgba(214, 240, 232, 0.85);
}

body.theme-light .fusion-log.fusion-log--failure {
  border-color: rgba(240, 150, 130, 0.5);
  background: rgba(250, 228, 224, 0.85);
}

.page--table { 
  max-width: none;
  width: 100%;
  padding: clamp(1rem, 3vw, 2.5rem);
  min-height: 0;
}

.page--table.active {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.page--gacha {
  display: none;
  position: relative;
  min-height: clamp(420px, 78vh, 780px);
  padding: clamp(1.2rem, 3vw, 2.4rem);
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.page--gacha.active {
  display: flex;
}

.gacha-ticket-counter {
  position: absolute;
  top: clamp(1rem, 3vw, 2rem);
  right: clamp(1rem, 3vw, 2rem);
  display: inline-flex;
  align-items: center;
  gap: 0.8rem;
  padding: 0.4rem 0.9rem;
  border-radius: 999px;
  font-size: 0.85rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-family: 'Orbitron', sans-serif;
  background: rgba(12, 16, 32, 0.55);
  color: rgba(255, 255, 255, 0.86);
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(6px);
}

.gacha-ticket-mode {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.25rem;
  padding: 0.2rem 0.4rem;
  background: none;
  border: 0;
  color: inherit;
  font: inherit;
  cursor: pointer;
  border-radius: 0.85rem;
  transition: transform 0.25s ease, background 0.3s ease;
}

.gacha-ticket-mode:focus-visible {
  outline: 2px solid rgba(255, 220, 140, 0.85);
  outline-offset: 3px;
}

.gacha-ticket-mode:hover,
.gacha-ticket-mode:focus-visible {
  background: rgba(255, 255, 255, 0.08);
  transform: translateY(-2px);
}

.gacha-ticket-mode__label {
  font-size: 0.62rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  pointer-events: none;
  white-space: nowrap;
}

.gacha-ticket-counter__icon {
  width: clamp(1.2rem, 3vw, 1.6rem);
  height: auto;
  filter: drop-shadow(0 0 6px rgba(255, 215, 120, 0.5));
  pointer-events: none;
  user-select: none;
}

.gacha-ticket-counter__value {
  white-space: nowrap;
}

body.theme-light .gacha-ticket-counter {
  background: rgba(240, 244, 255, 0.85);
  color: rgba(12, 16, 32, 0.75);
  box-shadow: 0 12px 24px rgba(10, 14, 28, 0.12);
}

body.theme-neon .gacha-ticket-counter {
  background: rgba(70, 90, 220, 0.65);
  color: #f6f8ff;
  box-shadow: 0 14px 32px rgba(40, 60, 160, 0.45);
}

.gacha-sun-button {
  position: relative;
  width: min(420px, 70vw);
  aspect-ratio: 1 / 1;
  border: 0;
  border-radius: 50%;
  background: radial-gradient(circle at center, rgba(255, 199, 72, 0.32), rgba(255, 199, 72, 0) 70%);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform 0.45s ease, filter 0.45s ease, box-shadow 0.45s ease;
  box-shadow: 0 0 70px rgba(255, 180, 70, 0.38), inset 0 0 28px rgba(255, 222, 168, 0.45);
  isolation: isolate;
}

.gacha-sun-button img {
  width: 44%;
  height: auto;
  pointer-events: none;
  user-select: none;
  filter: drop-shadow(0 0 45px rgba(255, 195, 90, 0.55));
}

.gacha-sun-button::after {
  content: '';
  position: absolute;
  inset: 12%;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.2), transparent 70%);
  opacity: 0;
  transition: opacity 0.45s ease;
  pointer-events: none;
}

.gacha-sun-button:focus-visible {
  outline: 3px solid rgba(255, 220, 140, 0.9);
  outline-offset: 6px;
}

.gacha-sun-button:not(.is-locked):hover,
.gacha-sun-button:not(.is-locked):focus-visible {
  transform: scale(1.04);
  box-shadow: 0 0 90px rgba(255, 200, 110, 0.6), inset 0 0 36px rgba(255, 240, 200, 0.55);
}

.gacha-sun-button:not(.is-locked):hover::after,
.gacha-sun-button:not(.is-locked):focus-visible::after {
  opacity: 1;
}

.gacha-sun-button.is-locked {
  cursor: not-allowed;
  filter: grayscale(0.4) brightness(0.92);
  box-shadow: 0 0 40px rgba(80, 80, 80, 0.24), inset 0 0 16px rgba(255, 255, 255, 0.2);
}

.gacha-animation-layer {
  --gacha-color: #ffd56a;
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1.4rem;
  background: radial-gradient(circle at center, rgba(1, 3, 12, 0.82) 0%, rgba(0, 0, 0, 0.98) 70%);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.6s ease;
  overflow: hidden;
  z-index: 10;
}

.gacha-animation-layer.is-active {
  opacity: 1;
  pointer-events: auto;
}

.gacha-animation-layer::before {
  content: '';
  position: absolute;
  inset: -60%;
  background: radial-gradient(circle at center, rgba(255, 255, 255, 0.16) 0%, transparent 68%);
  mix-blend-mode: screen;
  opacity: 0.55;
  filter: blur(22px);
  animation: gacha-pulse 4.2s ease-in-out infinite;
}


.gacha-confetti-layer {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
}

.gacha-confetti {
  position: absolute;
  top: 50%;
  left: 50%;
  display: block;
  opacity: 0;
  border-radius: 0.4rem;
  transform: translate(-50%, -50%) scale(0.85);
  transform-origin: center;
  pointer-events: none;
  --confetti-mid-x: 0px;
  --confetti-mid-y: 0px;
  --confetti-end-x: 0px;
  --confetti-end-y: 0px;
  --confetti-scale: 1;
  --confetti-start-rotation: 0deg;
  --confetti-mid-rotation: 0deg;
  --confetti-end-rotation: 0deg;
  --confetti-delay: 0s;
  --confetti-duration: 2.1s;
  background: linear-gradient(135deg, rgba(79, 126, 194, 0.9), rgba(32, 64, 120, 0.95));
  background-size: 150% 150%;
  background-position: center;
  box-shadow:
    0 0 18px rgba(120, 167, 242, 0.4),
    0 0 36px rgba(120, 167, 242, 0.18);
  filter: saturate(1.2);
  animation: gacha-confetti-shoot var(--confetti-duration, 2.1s) ease-out forwards;
  animation-delay: var(--confetti-delay, 0s);
  transition: background 0.6s ease, box-shadow 0.6s ease, filter 0.6s ease;
  mix-blend-mode: screen;
  will-change: transform, opacity;
}

.gacha-overlay {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, rgba(0, 0, 0, 0) 55%, rgba(0, 0, 0, 0.9) 100%);
  pointer-events: none;
  z-index: 1;
}

.gacha-result {
  position: relative;
  margin: 0;
  padding: 1.8rem clamp(1.4rem, 4vw, 3rem);
  border-radius: 28px;
  background: rgba(12, 14, 26, 0.4);
  backdrop-filter: blur(8px);
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.55);
  border: 1px solid rgba(255, 255, 255, 0.22);
  color: #ffffff;
  text-align: center;
  opacity: 0;
  transform: scale(0.84);
  transition: opacity 0.5s ease, transform 0.5s ease;
  z-index: 2;
  user-select: none;
  -webkit-user-select: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(1rem, 3vw, 1.6rem);
}

.gacha-result__grid {
  width: min(576px, 82vw);
  display: grid;
  gap: clamp(0.64rem, 1.92vw, 1.12rem);
  grid-template-columns: repeat(auto-fit, minmax(128px, 1fr));
  margin: 0;
  padding: 0;
  list-style: none;
}

.gacha-result-card {
  --rarity-color: rgba(255, 255, 255, 0.5);
  position: relative;
  padding: clamp(0.72rem, 1.76vw, 1.12rem);
  border-radius: 16px;
  background: linear-gradient(160deg, rgba(18, 22, 42, 0.85), rgba(8, 10, 22, 0.65));
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow:
    0 18px 34px rgba(0, 0, 0, 0.38),
    0 0 0 1px rgba(255, 255, 255, 0.08),
    0 0 36px rgba(255, 255, 255, 0.08);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.44rem;
  text-align: center;
  overflow: hidden;
  transition: transform 0.35s ease, box-shadow 0.35s ease, border-color 0.35s ease;
}

.gacha-result-card::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0));
  opacity: 0.35;
  pointer-events: none;
}

.gacha-result-card::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: linear-gradient(145deg, var(--rarity-color, rgba(255, 255, 255, 0.8)), transparent 72%);
  opacity: 0.55;
  pointer-events: none;
  mix-blend-mode: screen;
}

.gacha-result-card:hover,
.gacha-result-card.is-new {
  transform: translateY(-4px);
  box-shadow:
    0 24px 40px rgba(0, 0, 0, 0.45),
    0 0 0 1px rgba(255, 255, 255, 0.12),
    0 0 42px var(--rarity-color, rgba(255, 255, 255, 0.45));
}

.gacha-result-card.is-duplicate {
  opacity: 0.92;
}

.gacha-result-card__rarity {
  font-size: 0.62rem;
  letter-spacing: 0.112em;
  text-transform: uppercase;
  color: var(--rarity-color, #fefefe);
}

.gacha-result-card__name {
  font-size: clamp(0.88rem, 1.92vw, 1.2rem);
  font-weight: 600;
  letter-spacing: 0.04em;
}

.gacha-result-card__status {
  font-size: 0.72rem;
  letter-spacing: 0.064em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.78);
}

.gacha-result-card__count {
  position: absolute;
  top: 0.44rem;
  right: 0.48rem;
  padding: 0.16rem 0.48rem;
  border-radius: 999px;
  font-size: 0.66rem;
  font-weight: 700;
  letter-spacing: 0.064em;
  text-transform: uppercase;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.92), var(--rarity-color, rgba(255, 255, 255, 0.85)));
  color: rgba(5, 8, 18, 0.9);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
}

.gacha-result__summary {
  margin: 0;
  font-size: clamp(0.85rem, 2vw, 1.05rem);
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.75);
}

.gacha-result__note {
  margin: 0;
  font-size: clamp(0.75rem, 1.6vw, 0.9rem);
  letter-spacing: 0.04em;
  color: rgba(255, 255, 255, 0.65);
}

.gacha-continue-hint {
  margin: 0;
  font-size: 0.95rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  opacity: 0;
  transform: translateY(16px);
  color: rgba(255, 255, 255, 0.75);
  text-shadow: 0 0 12px rgba(255, 255, 255, 0.35);
  transition: opacity 0.5s ease, transform 0.5s ease;
  z-index: 2;
}

.gacha-animation-layer.show-result .gacha-result {
  opacity: 1;
  transform: scale(1);
}

.gacha-animation-layer.show-result .gacha-continue-hint {
  opacity: 0.75;
  transform: translateY(0);
}

@keyframes gacha-confetti-shoot {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.35) rotate(var(--confetti-start-rotation, 0deg));
  }
  15% {
    opacity: 1;
  }
  55% {
    opacity: 1;
    transform: translate(
        calc(-50% + var(--confetti-mid-x, 0px)),
        calc(-50% + var(--confetti-mid-y, 0px))
      )
      scale(var(--confetti-scale, 1))
      rotate(var(--confetti-mid-rotation, 0deg));
  }
  100% {
    opacity: 0;
    transform: translate(
        calc(-50% + var(--confetti-end-x, 0px)),
        calc(-50% + var(--confetti-end-y, 0px))
      )
      scale(var(--confetti-scale, 1))
      rotate(var(--confetti-end-rotation, 0deg));
  }
}

@keyframes gacha-pulse {
  0%,
  100% {
    opacity: 0.5;
  }
  50% {
    opacity: 0.85;
  }
}

.periodic-table-wrapper {
  flex: 1;
  width: min(100%, 1600px);
  margin: 0 auto;
  padding: clamp(0.5rem, 1vw, 1rem);
  display: flex;
  align-items: stretch;
  justify-content: center;
  min-height: 0;
  overflow: auto;
  scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
}

.periodic-table-layout {
  display: flex;
  gap: clamp(1rem, 3vw, 2.5rem);
  align-items: flex-start;
  justify-content: center;
  width: 100%;
}

@media (max-width: 1100px) {
  .periodic-table-layout {
    flex-direction: column;
    align-items: center;
  }
}

.periodic-table {
  --cell-width: clamp(2.1rem, 2.94vw, 3.325rem);
  --cell-height: clamp(2.52rem, calc(((100vh - 22rem) / 9) * 0.7), 3.57rem);
  display: grid;
  grid-template-columns: repeat(18, minmax(var(--cell-width), 1fr));
  grid-auto-rows: var(--cell-height);
  gap: clamp(0.14rem, 0.42vw, 0.28rem);
  width: min(100%, 1400px);
}

.periodic-element {
  --category-strong: rgba(255, 255, 255, 0.08);
  --category-weak: rgba(255, 255, 255, 0.02);
  --category-border: rgba(255, 255, 255, 0.1);
  --rarity-color: transparent;
  --rarity-strong: var(--category-strong);
  --rarity-weak: var(--category-weak);
  --rarity-border: var(--category-border);
  --rarity-divider: rgba(0, 0, 0, 0.35);
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: clamp(0.105rem, 0.42vw, 0.245rem);
  padding: clamp(0.315rem, 0.7vw, 0.455rem);
  border-radius: 12px;
  background: linear-gradient(150deg, var(--category-strong), var(--category-weak));
  border: 1px solid var(--category-border);
  color: inherit;
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  min-height: var(--cell-height);
  text-align: center;
  text-decoration: none;
  overflow: hidden;
}

.periodic-element > * {
  position: relative;
  z-index: 2;
}

.periodic-element::before,
.periodic-element::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition);
}

.periodic-element::after {
  background: linear-gradient(160deg, var(--rarity-strong), var(--rarity-weak));
  clip-path: polygon(100% 0, 100% 100%, 0 100%);
  z-index: 0;
}

.periodic-element::before {
  background: linear-gradient(135deg, transparent 48%, var(--rarity-divider) 50%, transparent 52%);
  z-index: 1;
  mix-blend-mode: soft-light;
}

.periodic-element[data-rarity]::before,
.periodic-element[data-rarity]::after {
  opacity: 1;
}

.periodic-element[data-rarity] {
  --rarity-strong: var(--rarity-color, rgba(255, 255, 255, 0.16));
  --rarity-weak: var(--rarity-color, rgba(255, 255, 255, 0.08));
  --rarity-border: var(--rarity-color, rgba(255, 255, 255, 0.18));
  border-color: var(--rarity-border);
}

@supports (color-mix(in srgb, black 50%, white)) {
  .periodic-element[data-rarity] {
    --rarity-strong: color-mix(in srgb, var(--rarity-color, transparent) 70%, rgba(255, 255, 255, 0.14));
    --rarity-weak: color-mix(in srgb, var(--rarity-color, transparent) 45%, rgba(0, 0, 0, 0.22));
    --rarity-border: color-mix(in srgb, var(--rarity-color, transparent) 55%, rgba(255, 255, 255, 0.2));
    --rarity-divider: color-mix(in srgb, var(--rarity-color, transparent) 35%, rgba(0, 0, 0, 0.55));
  }

  .periodic-element[data-rarity] {
    border-color: color-mix(in srgb, var(--category-border) 55%, var(--rarity-border) 45%);
  }
}

.periodic-element:hover,
.periodic-element:focus-visible {
  transform: translateY(-2px);
  box-shadow: 0 12px 22px rgba(0, 0, 0, 0.28);
  border-color: var(--accent);
  outline: none;
}

.periodic-element.is-owned {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(76, 141, 255, 0.35);
}

.periodic-element.is-selected {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(76, 141, 255, 0.55);
}


.periodic-element__symbol {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(0.48rem, 1.2vw, 0.8rem);
  letter-spacing: 0.08em;
  line-height: 1;
}

.periodic-element__number {
  font-size: clamp(0.416rem, 0.64vw, 0.544rem);
  opacity: 0.75;
  line-height: 1;
}
.periodic-element__name {
  font-size: clamp(0.248rem, 0.4vw, 0.328rem);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.periodic-element__mass {
  font-size: clamp(0.232rem, 0.36vw, 0.312rem);
  opacity: 0.72;
}

.element-info-panel {
  --category-strong: rgba(255, 255, 255, 0.08);
  --category-weak: rgba(255, 255, 255, 0.02);
  --category-border: rgba(255, 255, 255, 0.1);
  grid-column: 3 / 13;
  grid-row: 1 / 4;
  align-self: stretch;
  display: flex;
  flex-direction: column;
  gap: clamp(0.4rem, 0.75vw, 0.575rem);
  padding: clamp(1.1rem, 2.2vw, 1.6rem);
  border-radius: 16px;
  background: linear-gradient(150deg, var(--category-strong), var(--category-weak));
  border: 1px solid var(--category-border);
  box-shadow: 0 14px 30px rgba(0, 0, 0, 0.28);
  color: inherit;
  min-width: 0;
  min-height: 0;
  justify-content: center;
}

.element-info-panel__placeholder {
  margin: 0;
  font-size: 0.475rem;
  opacity: 0.75;
  line-height: 1.25;
}

.element-info-panel__content {
  display: flex;
  flex-direction: column;
  gap: clamp(0.4rem, 0.8vw, 0.6rem);
}

.element-info-panel__header {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: start;
  gap: clamp(0.375rem, 0.75vw, 0.5rem);
}

.element-info-panel__identity {
  display: flex;
  flex-direction: column;
  gap: 0.075rem;
}

.element-info-panel__symbol-row {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: clamp(0.25rem, 0.6vw, 0.4rem);
}

.element-info-panel__number {
  font-size: clamp(0.375rem, 0.5vw, 0.45rem);
  font-weight: 600;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  opacity: 0.8;
  align-self: start;
}

.element-info-panel__symbol {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(1.1rem, 2.25vw, 1.6rem);
  letter-spacing: 0.1em;
  line-height: 1;
}

.element-info-panel__owned-count {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(0.65rem, 1.3vw, 0.9rem);
  font-weight: 600;
  line-height: 1;
  text-align: right;
  min-width: clamp(0.75rem, 1.5vw, 1.05rem);
}

.element-info-panel__name {
  font-size: clamp(0.5rem, 1.2vw, 0.7rem);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  opacity: 0.85;
}

.element-info-panel__details {
  display: grid;
  gap: clamp(0.225rem, 0.5vw, 0.35rem);
  margin: 0;
}

.element-info-panel__row {
  display: flex;
  justify-content: space-between;
  gap: 0.375rem;
  font-size: clamp(0.425rem, 0.75vw, 0.5rem);
  line-height: 1.2;
}

.element-info-panel__row dt {
  font-weight: 600;
  opacity: 0.75;
  line-height: 1.2;
}

.element-info-panel__row dd {
  margin: 0;
  text-align: right;
  font-weight: 500;
  line-height: 1.2;
}

.element-info-panel__value.element-info-panel__category,
.element-info-panel__value.element-info-panel__collection {
  font-size: clamp(0.64rem, 1.125vw, 0.75rem);
}

.element-info-panel__collection {
  line-height: 1.3;
  white-space: normal;
}

.periodic-placeholder {
  margin: 0;
  padding: clamp(1rem, 2vw, 1.4rem);
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.05);
  text-align: center;
  font-size: 0.95rem;
  opacity: 0.75;
}

.periodic-element[data-category='alkali-metal'],
.element-info-panel[data-category='alkali-metal'] {
  --category-strong: rgba(7, 70, 50, 0.38);
  --category-weak: rgba(7, 70, 50, 0.12);
  --category-border: rgba(7, 70, 50, 0.4);
}

.periodic-element[data-category='alkaline-earth-metal'],
.element-info-panel[data-category='alkaline-earth-metal'] {
  --category-strong: rgba(90, 101, 37, 0.36);
  --category-weak: rgba(90, 101, 37, 0.12);
  --category-border: rgba(90, 101, 37, 0.36);
}

.periodic-element[data-category='transition-metal'],
.element-info-panel[data-category='transition-metal'] {
  --category-strong: rgba(188, 116, 58, 0.36);
  --category-weak: rgba(188, 116, 58, 0.12);
  --category-border: rgba(188, 116, 58, 0.36);
}

.periodic-element[data-category='post-transition-metal'],
.element-info-panel[data-category='post-transition-metal'] {
  --category-strong: rgba(201, 150, 77, 0.36);
  --category-weak: rgba(201, 150, 77, 0.12);
  --category-border: rgba(201, 150, 77, 0.36);
}

.periodic-element[data-category='metalloid'],
.element-info-panel[data-category='metalloid'] {
  --category-strong: rgba(211, 184, 104, 0.32);
  --category-weak: rgba(211, 184, 104, 0.12);
  --category-border: rgba(211, 184, 104, 0.32);
}

.periodic-element[data-category='nonmetal'],
.element-info-panel[data-category='nonmetal'] {
  --category-strong: rgba(117, 165, 158, 0.36);
  --category-weak: rgba(117, 165, 158, 0.14);
  --category-border: rgba(117, 165, 158, 0.34);
}

.periodic-element[data-category='halogen'],
.element-info-panel[data-category='halogen'] {
  --category-strong: rgba(88, 142, 127, 0.36);
  --category-weak: rgba(88, 142, 127, 0.14);
  --category-border: rgba(88, 142, 127, 0.34);
}

.periodic-element[data-category='noble-gas'],
.element-info-panel[data-category='noble-gas'] {
  --category-strong: rgba(63, 119, 95, 0.36);
  --category-weak: rgba(63, 119, 95, 0.14);
  --category-border: rgba(63, 119, 95, 0.34);
}

.periodic-element[data-category='lanthanide'],
.element-info-panel[data-category='lanthanide'] {
  --category-strong: rgba(49, 124, 83, 0.34);
  --category-weak: rgba(49, 124, 83, 0.12);
  --category-border: rgba(49, 124, 83, 0.32);
}

.periodic-element[data-category='actinide'],
.element-info-panel[data-category='actinide'] {
  --category-strong: rgba(42, 157, 88, 0.34);
  --category-weak: rgba(42, 157, 88, 0.12);
  --category-border: rgba(42, 157, 88, 0.32);
}

body.theme-light .periodic-table-wrapper {
  scrollbar-color: rgba(12, 16, 32, 0.2) transparent;
}

body.theme-light .periodic-element:hover,
body.theme-light .periodic-element:focus-visible {
  box-shadow: 0 12px 22px rgba(10, 16, 32, 0.18);
}

body.theme-light .periodic-placeholder {
  background: rgba(12, 16, 32, 0.08);
}

body.theme-neon .periodic-element:hover,
body.theme-neon .periodic-element:focus-visible {
  box-shadow: 0 14px 24px rgba(90, 120, 255, 0.28);
}

body.theme-neon .periodic-placeholder {
  background: rgba(90, 120, 255, 0.12);
}

.page--void {
  position: relative;
  max-width: none;
  padding: clamp(2.4rem, 7vw, 5rem);
  min-height: max(100%, clamp(420px, 85vh, 1200px));
  background: radial-gradient(circle at 50% 20%, rgba(255, 200, 120, 0.08) 0%, rgba(12, 12, 16, 0.92) 45%, #020207 100%);
  overflow: hidden;
  isolation: isolate;
  user-select: none;
}

.page--void.active {
  display: grid;
  place-items: center;
}

body.theme-light .page--void,
body.theme-neon .page--void {
  color: var(--fg-dark);
  background: radial-gradient(circle at 50% 22%, rgba(255, 200, 120, 0.08) 0%, rgba(10, 10, 16, 0.92) 42%, #020207 100%);
}

.page--void::after {
  content: '';
  position: absolute;
  inset: -15%;
  background: radial-gradient(circle at center, rgba(255, 230, 180, 0.08) 0%, rgba(255, 120, 40, 0.04) 18%, rgba(5, 6, 12, 0.9) 60%, #010103 100%);
  filter: blur(28px);
  z-index: 0;
  pointer-events: none;
}

.starfield {
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
}

.frenzy-layer {
  position: absolute;
  inset: 0;
  z-index: 3;
  pointer-events: none;
}

.ticket-layer {
  position: absolute;
  inset: 0;
  z-index: 2;
  pointer-events: none;
}

.ticket-star {
  position: absolute;
  left: 0;
  top: 0;
  width: var(--ticket-star-size, clamp(52px, 9vw, 96px));
  height: var(--ticket-star-size, clamp(52px, 9vw, 96px));
  border: none;
  padding: 0;
  background: transparent;
  cursor: pointer;
  transform: translate(0, 0);
  transition: transform 0.18s ease, filter 0.18s ease;
  will-change: transform;
  pointer-events: auto;
}

.ticket-star:hover {
  filter: drop-shadow(0 0 12px rgba(255, 210, 120, 0.65));
}

.ticket-star:focus-visible {
  outline: 2px solid rgba(255, 230, 150, 0.9);
  outline-offset: 4px;
}

.ticket-star img {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: contain;
  pointer-events: none;
}

.frenzy-token {
  position: absolute;
  width: clamp(54px, 9vw, 96px);
  aspect-ratio: 1 / 1;
  border: none;
  padding: 0;
  background: transparent;
  cursor: pointer;
  transform: translate(-50%, -50%) scale(0.85);
  transition: transform 0.18s ease, opacity 0.18s ease;
  animation: frenzy-pop 0.3s ease-out forwards;
  pointer-events: auto;
}

.frenzy-token:hover {
  transform: translate(-50%, -50%) scale(0.95);
}

.frenzy-token:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 4px;
  transform: translate(-50%, -50%) scale(0.95);
}

.frenzy-token img {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events: none;
}

.frenzy-token--perClick {
  filter:
    drop-shadow(0 12px 18px rgba(0, 0, 0, 0.38))
    drop-shadow(0 0 12px rgba(255, 120, 64, 0.6))
    drop-shadow(0 16px 28px rgba(255, 120, 64, 0.25));
}

.frenzy-token--perSecond {
  filter:
    drop-shadow(0 12px 18px rgba(0, 0, 0, 0.38))
    drop-shadow(0 0 12px rgba(120, 180, 255, 0.6))
    drop-shadow(0 16px 28px rgba(120, 180, 255, 0.25));
}

.frenzy-token.is-expiring {
  opacity: 0;
}

@keyframes frenzy-pop {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.6);
  }
  60% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.05);
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(0.9);
  }
}

.starfield__star {
  position: absolute;
  width: 2.5px;
  height: 2.5px;
  border-radius: 50%;
  transform: translate(-50%, -50%) scale(var(--star-scale, 1));
  background: radial-gradient(circle, rgba(255, 235, 190, 0.95) 0%, rgba(255, 210, 150, 0.75) 30%, rgba(255, 210, 150, 0.02) 75%);
  box-shadow: 0 0 12px rgba(255, 210, 150, 0.35);
  mix-blend-mode: screen;
  filter: blur(0.35px);
  animation: starTwinkle 7.5s ease-in-out infinite;
}

@keyframes starTwinkle {
  0%, 100% {
    opacity: calc(var(--star-opacity, 0.32) * 0.55);
    transform: translate(-50%, -50%) scale(calc(var(--star-scale, 1) * 0.85));
  }
  40% {
    opacity: calc(var(--star-opacity, 0.32) * 1.65);
    transform: translate(-50%, -50%) scale(calc(var(--star-scale, 1) * 1.35));
  }
  60% {
    opacity: calc(var(--star-opacity, 0.32) * 1.1);
    transform: translate(-50%, -50%) scale(calc(var(--star-scale, 1) * 1.1));
  }
}

.game-header {
  text-align: center;
  margin: 0 auto clamp(1.2rem, 3vw, 2rem);
}

.game-header h2 {
  margin: 0 0 0.5rem 0;
  font-family: 'Orbitron', sans-serif;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.game-sub {
  margin: 0;
  opacity: 0.74;
  font-size: 0.95rem;
}

.atom-button {
  --glow-strength: 0;
  --glow-color: 255, 236, 170;
  --critical-flash: 0;
  position: relative;
  display: block;
  width: clamp(110px, 24vw, 180px);
  aspect-ratio: 1 / 1;
  margin: 0;
  padding: 0;
  border: none;
  background: transparent;
  cursor: pointer;
  z-index: 2;
  touch-action: manipulation;
}

.atom-button::before,
.atom-button::after {
  content: '';
  position: absolute;
  inset: 6%;
  border-radius: 50%;
  pointer-events: none;
  transition: opacity 0.2s ease, filter 0.2s ease, transform 0.2s ease;
}

.atom-button::before {
  background: radial-gradient(circle, rgba(var(--glow-color), calc(0.42 + 0.52 * var(--glow-strength))) 0%, rgba(var(--glow-color), calc(0.22 + 0.45 * var(--glow-strength))) 42%, rgba(var(--glow-color), 0) 72%);
  filter:
    blur(calc(22px + 96px * var(--glow-strength)))
    brightness(calc(1 + 0.35 * var(--critical-flash)));
  opacity: calc(0.52 + 0.48 * var(--glow-strength));
  transform: scale(calc(0.85 + 0.6 * var(--glow-strength) + 0.1 * var(--critical-flash)));
  mix-blend-mode: screen;
}

.atom-button::after {
  inset: -8%;
  box-shadow:
    0 0 calc(40px + 90px * var(--glow-strength)) rgba(var(--glow-color), calc(0.24 + 0.5 * var(--glow-strength))),
    0 0 calc(80px + 140px * var(--glow-strength)) rgba(var(--glow-color), calc(0.12 + 0.35 * var(--glow-strength)));
  opacity: calc(0.45 + 0.45 * var(--glow-strength) + 0.2 * var(--critical-flash));
  filter: brightness(calc(1 + 0.25 * var(--critical-flash)));
}

.atom-button.is-critical {
  --critical-flash: 1;
}

.crit-confetti-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 40;
}

.crit-confetti {
  position: absolute;
  display: block;
  transform: translate(-50%, -50%) scale(var(--confetti-scale, 1)) rotate(var(--confetti-rotation, 0deg));
  opacity: 0;
  border-radius: 0.35rem;
  background-size: 140% 140%;
  background-position: center;
  animation: crit-confetti-float var(--confetti-duration, 3s) ease-in-out forwards;
  animation-delay: var(--confetti-delay, 0s);
  pointer-events: none;
  mix-blend-mode: screen;
}

.crit-confetti--circle {
  border-radius: 50%;
}

.crit-confetti--oval {
  border-radius: 48% / 70%;
}

.crit-confetti--heart {
  border-radius: 0;
  clip-path: polygon(50% 14%, 61% 0, 78% 0, 93% 14%, 100% 32%, 95% 52%, 78% 74%, 50% 100%, 22% 74%, 5% 52%, 0 32%, 7% 14%, 22% 0, 39% 0);
}

.crit-confetti--star {
  border-radius: 0;
  clip-path: polygon(50% 0%, 62% 35%, 100% 38%, 70% 60%, 82% 100%, 50% 78%, 18% 100%, 30% 60%, 0% 38%, 38% 35%);
}

.crit-confetti--square {
  border-radius: 0.2rem;
}

.crit-confetti--triangle {
  border-radius: 0;
  clip-path: polygon(50% 6%, 0% 100%, 100% 100%);
}

.crit-confetti--rectangle {
  border-radius: 0.45rem;
}

.crit-confetti--hexagon {
  border-radius: 0;
  clip-path: polygon(25% 6.5%, 75% 6.5%, 100% 50%, 75% 93.5%, 25% 93.5%, 0% 50%);
}

@keyframes crit-confetti-float {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(var(--confetti-scale, 1)) rotate(var(--confetti-rotation, 0deg));
  }
  12% {
    opacity: 1;
  }
  68% {
    opacity: 1;
    transform: translate(
      calc(-50% + var(--confetti-drift-x, 0px)),
      calc(-50% + var(--confetti-drift-y, 0px))
    ) scale(var(--confetti-scale, 1)) rotate(var(--confetti-end-rotation, 0deg));
  }
  100% {
    opacity: 0;
    transform: translate(
      calc(-50% + var(--confetti-end-x, 0px)),
      calc(-50% + var(--confetti-end-y, 0px))
    ) scale(var(--confetti-scale, 1)) rotate(
      calc(var(--confetti-end-rotation, 0deg) + var(--confetti-spin, 90deg))
    );
  }
}

.atom-visual {
  position: relative;
  display: block;
  width: 100%;
  height: 100%;
  --shake-x: 0px;
  --shake-y: 0px;
  --shake-rot: 0deg;
  --shake-scale-x: 1;
  --shake-scale-y: 1;
  transform-origin: center;
  transform: translate3d(var(--shake-x), var(--shake-y), 0) rotate(var(--shake-rot)) scaleX(var(--shake-scale-x))
    scaleY(var(--shake-scale-y));
  will-change: transform;
}

.atom-image {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: contain;
  user-select: none;
  -webkit-user-drag: none;
  filter:
    drop-shadow(0 0 calc(24px + 68px * var(--glow-strength)) rgba(var(--glow-color), calc(0.45 + 0.52 * var(--glow-strength))))
    drop-shadow(0 0 calc(45px + 120px * var(--glow-strength)) rgba(var(--glow-color), calc(0.18 + 0.35 * var(--glow-strength))));
  transition: filter 0.14s ease;
}

.milestones {
  margin-top: clamp(1.2rem, 2vw, 1.8rem);
  padding: clamp(1rem, 2vw, 1.4rem);
  border-radius: 16px;
  background: rgba(255,255,255,0.05);
  font-size: 0.95rem;
}

.section-intro {
  margin-top: 0;
  opacity: 0.7;
}

.shop-list {
  display: flex;
  flex-direction: column;
  gap: clamp(0.4rem, 1vw, 0.7rem);
  margin-top: clamp(0.4rem, 0.8vw, 0.6rem);
  width: 100%;
}

.shop-item {
  list-style: none;
  background: var(--card-dark);
  border-radius: 10px;
  padding: clamp(0.55rem, 1.2vw, 0.9rem) clamp(0.75rem, 1.8vw, 1.1rem);
  display: grid;
  grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
  grid-template-areas:
    "header actions"
    "desc actions";
  gap: clamp(0.3rem, 0.8vw, 0.5rem) clamp(0.6rem, 1.2vw, 0.9rem);
  align-items: center;
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: none;
  transition: border var(--transition), box-shadow var(--transition), background var(--transition);
}

.shop-item[hidden],
.shop-item--locked {
  display: none !important;
}

.shop-item--ready {
  border-color: rgba(76, 141, 255, 0.38);
  box-shadow: 0 10px 22px rgba(76, 141, 255, 0.18);
}

.shop-item__header {
  grid-area: header;
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0.35rem 0.6rem;
}

.shop-item__header h3 {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 0.85rem;
}

.shop-item__level {
  font-size: 0.65rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.65;
}

.shop-item__description {
  grid-area: desc;
  margin: 0;
  opacity: 0.8;
  line-height: 1.35;
  font-size: 0.78rem;
}

.shop-item__actions {
  grid-area: actions;
  display: flex;
  flex-wrap: nowrap;
  gap: clamp(0.35rem, 0.8vw, 0.55rem);
  justify-content: flex-end;
  align-items: stretch;
}

.shop-item__action {
  border: 1px solid transparent;
  padding: 0.45rem 0.75rem;
  border-radius: 14px;
  font-family: 'Orbitron', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  cursor: pointer;
  transition: background var(--transition), color var(--transition), transform var(--transition), box-shadow var(--transition),
    border var(--transition);
  background: var(--accent);
  color: #05070c;
  min-width: 96px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.68rem;
}

.shop-item__action-quantity {
  font-size: 0.78rem;
}

.shop-item__action-price {
  font-size: 0.65rem;
  opacity: 0.8;
}

.shop-item__action.is-ready {
  box-shadow: 0 10px 24px rgba(76, 141, 255, 0.25);
}

.shop-item__action:disabled {
  background: rgba(255, 255, 255, 0.12);
  color: rgba(255, 255, 255, 0.6);
  cursor: not-allowed;
  border-color: rgba(255, 255, 255, 0.16);
  box-shadow: none;
}

body.theme-light .shop-item {
  background: rgba(12, 16, 32, 0.04);
  border-color: rgba(12, 16, 32, 0.08);
}

body.theme-light .shop-item--ready {
  border-color: rgba(76, 141, 255, 0.35);
  box-shadow: 0 10px 20px rgba(76, 141, 255, 0.2);
}

body.theme-light .shop-item__action:disabled {
  background: rgba(12, 16, 32, 0.08);
  color: rgba(12, 16, 32, 0.55);
  border-color: rgba(12, 16, 32, 0.12);
}

body.theme-neon .shop-item {
  background: rgba(90, 110, 255, 0.12);
  border-color: rgba(120, 140, 255, 0.2);
}

body.theme-neon .shop-item--ready {
  border-color: rgba(122, 255, 255, 0.32);
  box-shadow: 0 14px 26px rgba(140, 180, 255, 0.24);
}

body.theme-neon .shop-item__action:disabled {
  background: rgba(40, 48, 120, 0.32);
  color: rgba(220, 230, 255, 0.65);
  border-color: rgba(110, 130, 255, 0.24);
}

@media (max-width: 960px) {
  .shop-item {
    grid-template-columns: minmax(0, 1fr);
    grid-template-areas:
      "header"
      "desc"
      "actions";
    align-items: flex-start;
  }

  .shop-item__actions {
    justify-content: flex-start;
    flex-wrap: wrap;
  }
}

@media (max-width: 640px) {
  .shop-item__actions {
    gap: 0.4rem;
    flex-wrap: wrap;
  }

  .shop-item__action {
    flex: 1 1 calc(33% - 0.4rem);
  }
}

.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0 0 0 0);
  white-space: nowrap;
  border: 0;
}

.info-grid {
  display: grid;
  gap: clamp(1.2rem, 2.4vw, 2rem);
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  align-items: stretch;
}

.info-card {
  background: var(--card-dark);
  border-radius: 18px;
  padding: clamp(1.4rem, 2.4vw, 2rem);
  box-shadow: 0 24px 48px rgba(0,0,0,0.22);
  line-height: 1.6;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

body.theme-light .info-card {
  background: var(--card-light);
  box-shadow: 0 24px 48px rgba(12, 16, 32, 0.12);
}

body.theme-neon .info-card {
  background: var(--card-neon);
  box-shadow: 0 24px 48px rgba(80, 100, 255, 0.18);
}

.info-card h2,
.info-card h3,
.info-card h4 {
  font-family: 'Orbitron', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.12em;
}

.info-card__header {
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
}

.info-card__subtitle {
  font-size: 0.8rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.6;
  margin: 0;
}

.info-card--progression {
  gap: clamp(1rem, 1.8vw, 1.4rem);
}

.info-progress-grid {
  display: grid;
  gap: clamp(0.8rem, 1.6vw, 1.4rem);
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.info-progress-block {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.info-progress-block h4 {
  margin: 0;
  font-size: 0.85rem;
  letter-spacing: 0.1em;
  opacity: 0.7;
}

.info-metrics {
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.6rem;
}

.info-metrics__row {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 1.2rem;
}

.info-metrics__row dt {
  font-weight: 600;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin: 0;
}

.info-metrics__row dd {
  margin: 0;
  font-weight: 600;
  font-size: 0.95rem;
  text-align: right;
}

.production-breakdown {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 0.55rem;
}

.production-breakdown__row {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 1rem;
  font-size: 0.9rem;
}

.production-breakdown__row--total {
  padding-top: 0.6rem;
  margin-top: 0.3rem;
  border-top: 1px solid rgba(255,255,255,0.12);
  font-size: 1rem;
}

body.theme-light .production-breakdown__row--total {
  border-color: rgba(12,16,32,0.12);
}

body.theme-neon .production-breakdown__row--total {
  border-color: rgba(80,100,255,0.24);
}

.production-breakdown__label {
  text-transform: uppercase;
  letter-spacing: 0.06em;
  font-size: 0.78rem;
  opacity: 0.7;
}

.info-card--bonuses {
  gap: clamp(1rem, 1.8vw, 1.5rem);
  grid-column: 1 / -1;
}

.info-card--bonuses .element-bonus-list {
  display: flex;
  flex-direction: column;
  gap: clamp(1rem, 1.6vw, 1.35rem);
  align-items: stretch;
}

.info-card--bonuses .shop-bonus-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
}

@media (max-width: 720px) {
  .info-card--bonuses .shop-bonus-list {
    grid-template-columns: minmax(0, 1fr);
  }
}

.element-bonus-card {
  background: rgba(255,255,255,0.05);
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  padding: clamp(0.35rem, 0.8vw, 0.55rem) clamp(0.5rem, 1vw, 0.75rem);
  display: flex;
  flex-direction: column;
  gap: clamp(0.3rem, 0.6vw, 0.45rem);
  height: 100%;
  width: 100%;
}

body.theme-light .element-bonus-card {
  background: rgba(12,16,32,0.05);
  border-color: rgba(12,16,32,0.1);
}

body.theme-neon .element-bonus-card {
  background: rgba(80, 100, 255, 0.08);
  border-color: rgba(120, 140, 255, 0.22);
}

.element-bonus-card:not(.shop-bonus-card) {
  display: grid;
  grid-template-columns: minmax(140px, 0.6fr) minmax(0, 1fr);
  align-items: center;
  gap: clamp(0.35rem, 0.7vw, 0.5rem);
  min-height: clamp(56px, 5vw, 90px);
  aspect-ratio: 8 / 1;
}

.element-bonus-card:not(.shop-bonus-card) .element-bonus-card__meta,
.element-bonus-card:not(.shop-bonus-card) .element-bonus-card__details {
  min-width: 0;
  display: grid;
  align-content: start;
  gap: clamp(0.3rem, 0.6vw, 0.45rem);
}

.element-bonus-card:not(.shop-bonus-card) .element-bonus-card__meta {
  grid-template-rows: auto auto;
}

@media (max-width: 1200px) {
  .element-bonus-card:not(.shop-bonus-card) {
    grid-template-columns: minmax(160px, 0.75fr) minmax(0, 1fr);
  }
}

@media (max-width: 960px) {
  .element-bonus-card:not(.shop-bonus-card) {
    grid-template-columns: minmax(0, 1fr);
    min-height: auto;
    aspect-ratio: auto;
  }
}

.element-bonus-card__meta {
  display: flex;
  flex-direction: column;
  gap: clamp(0.2rem, 0.5vw, 0.35rem);
}

.element-bonus-counts {
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: clamp(0.2rem, 0.4vw, 0.35rem);
}

.element-bonus-count {
  display: grid;
  grid-template-rows: auto auto;
  gap: 0.12rem;
  align-content: start;
}

.element-bonus-count__label {
  font-size: 0.62rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.7;
  min-width: 0;
}

.element-bonus-count__value {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.85rem;
  min-width: 0;
  word-break: break-word;
}

.element-bonus-count--highlight .element-bonus-count__value {
  color: #74f5c6;
}

body.theme-light .element-bonus-count--highlight .element-bonus-count__value {
  color: #0b8e72;
}

.element-bonus-progress {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.element-bonus-progress__label {
  font-size: 0.78rem;
  letter-spacing: 0.06em;
  opacity: 0.75;
}

.element-bonus-progress__track {
  position: relative;
  height: 0.35rem;
  border-radius: 999px;
  background: rgba(255,255,255,0.12);
  overflow: hidden;
}

body.theme-light .element-bonus-progress__track {
  background: rgba(12,16,32,0.16);
}

body.theme-neon .element-bonus-progress__track {
  background: rgba(120, 140, 255, 0.26);
}

.element-bonus-progress__fill {
  height: 100%;
  border-radius: inherit;
  background: linear-gradient(120deg, rgba(116, 245, 198, 0.8), rgba(0, 181, 255, 0.9));
  transition: width 0.4s ease;
}

body.theme-light .element-bonus-progress__fill {
  background: linear-gradient(120deg, rgba(12, 160, 140, 0.82), rgba(0, 120, 200, 0.86));
}

.element-bonus-card__details {
  display: flex;
  flex-direction: column;
  gap: clamp(0.4rem, 0.9vw, 0.7rem);
}

@media (min-width: 960px) {
  .element-bonus-card:not(.shop-bonus-card) .element-bonus-card__details {
    grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
    gap: clamp(0.7rem, 1vw, 1rem);
  }
}

.element-bonus-section {
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  min-width: 0;
}

.element-bonus-section__title {
  margin: 0;
  font-size: 0.74rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  opacity: 0.7;
}

.element-bonus-card--complete {
  border-color: rgba(116, 245, 198, 0.55);
  box-shadow: 0 0 0 1px rgba(116, 245, 198, 0.25);
}

.shop-bonus-card--inactive {
  opacity: 0.65;
}

.shop-bonus-card--inactive .element-bonus-card__status {
  background: rgba(255,255,255,0.08);
}

body.theme-light .shop-bonus-card--inactive .element-bonus-card__status {
  background: rgba(12,16,32,0.12);
}

.shop-bonus-card--revealed {
  animation: shopBonusCardReveal 0.42s ease-out both;
}

@keyframes shopBonusCardReveal {
  from {
    opacity: 0;
    transform: translateY(14px) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.element-bonus-card__header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 0.6rem;
}

.element-bonus-card__header h4 {
  margin: 0;
  font-size: 0.9rem;
}

.element-bonus-card__status {
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 0.2rem 0.6rem;
  border-radius: 999px;
  background: rgba(255,255,255,0.12);
}

body.theme-light .element-bonus-card__status {
  background: rgba(12,16,32,0.12);
}

.shop-bonus-card__summary {
  margin: 0;
  font-size: 0.78rem;
  line-height: 1.5;
  opacity: 0.75;
}

.element-bonus-effects {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: clamp(0.45rem, 0.8vw, 0.75rem);
}

.element-bonus-effects__item {
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 0.55rem 0.8rem;
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 0.5rem;
  min-width: 0;
}

body.theme-light .element-bonus-effects__item {
  background: rgba(12,16,32,0.08);
}

.element-bonus-effects__label {
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.68;
  min-width: 0;
}

.element-bonus-effects__value {
  font-family: 'Orbitron', sans-serif;
  font-size: 1rem;
  text-align: right;
  white-space: normal;
  word-break: break-word;
  min-width: 0;
}

.element-bonus-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem;
}

.element-bonus-tag {
  font-size: 0.7rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 0.22rem 0.6rem;
  border-radius: 999px;
  background: rgba(255,255,255,0.12);
}

body.theme-light .element-bonus-tag {
  background: rgba(12,16,32,0.14);
}

.element-bonus-tag[data-tooltip] {
  position: relative;
  cursor: help;
  outline: none;
}

.element-bonus-tag[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 0.55rem);
  transform: translate(-50%, 0.2rem);
  background: rgba(12,16,32,0.92);
  color: #fff;
  padding: 0.55rem 0.7rem;
  border-radius: 8px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.4);
  font-size: 0.72rem;
  line-height: 1.4;
  width: max-content;
  max-width: min(280px, 70vw);
  white-space: normal;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.18s ease, transform 0.18s ease;
  z-index: 20;
}

.element-bonus-tag[data-tooltip]::before {
  content: '';
  position: absolute;
  left: 50%;
  bottom: calc(100% + 0.25rem);
  transform: translateX(-50%) scale(0.9);
  border: 6px solid transparent;
  border-top-color: rgba(12,16,32,0.92);
  opacity: 0;
  transition: opacity 0.18s ease, transform 0.18s ease;
  z-index: 19;
}

.element-bonus-tag[data-tooltip]:hover::after,
.element-bonus-tag[data-tooltip]:focus::after,
.element-bonus-tag[data-tooltip]:focus-visible::after {
  opacity: 1;
  transform: translate(-50%, 0);
}

.element-bonus-tag[data-tooltip]:hover::before,
.element-bonus-tag[data-tooltip]:focus::before,
.element-bonus-tag[data-tooltip]:focus-visible::before {
  opacity: 1;
  transform: translateX(-50%) scale(1);
}

.element-bonus-tag[data-tooltip]:focus-visible {
  outline: 2px solid rgba(255,255,255,0.65);
  outline-offset: 2px;
}

body.theme-light .element-bonus-tag[data-tooltip]::after {
  background: rgba(12,16,32,0.94);
  color: #f1f3ff;
  box-shadow: 0 10px 28px rgba(12,16,32,0.35);
}

body.theme-light .element-bonus-tag[data-tooltip]::before {
  border-top-color: rgba(12,16,32,0.94);
}

body.theme-light .element-bonus-tag[data-tooltip]:focus-visible {
  outline-color: rgba(12,16,32,0.6);
}

.element-bonus-specials {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: clamp(0.45rem, 0.8vw, 0.75rem);
}

.element-bonus-specials__item {
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 0.55rem 0.8rem;
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 0.5rem;
  min-width: 0;
}

body.theme-light .element-bonus-specials__item {
  background: rgba(12,16,32,0.08);
}

.element-bonus-specials__label {
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.68;
  min-width: 0;
}

.element-bonus-specials__value {
  font-family: 'Orbitron', sans-serif;
  font-size: 1rem;
  text-align: right;
  white-space: normal;
  word-break: break-word;
  min-width: 0;
}

.element-bonus-empty {
  margin: 0;
  font-size: 0.78rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.55;
}

.production-breakdown__row--total .production-breakdown__label {
  opacity: 0.9;
}

.production-breakdown__value {
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  font-size: 0.95rem;
}

.production-breakdown__row--multiplier .production-breakdown__value {
  color: var(--accent);
}

@media (max-width: 720px) {
  .info-grid {
    grid-template-columns: 1fr;
  }

  .info-card {
    padding: clamp(1.2rem, 4vw, 1.6rem);
  }
}

.options-grid {
  display: grid;
  gap: clamp(1rem, 2vw, 1.6rem);
}

#options.page.active {
  display: flex;
  flex-direction: column;
  gap: clamp(1.2rem, 2vw, 1.8rem);
}

#options.page {
  position: relative;
}

.option-card {
  background: var(--card-dark);
  border-radius: 18px;
  padding: clamp(1.2rem, 2vw, 1.6rem);
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.options-reset {
  margin-top: auto;
  display: flex;
  justify-content: flex-end;
}

.options-reset > #resetButton {
  align-self: flex-end;
}

.goals-list {
  display: grid;
  gap: clamp(0.9rem, 2vw, 1.4rem);
  margin-top: clamp(1rem, 2vw, 1.6rem);
}

.goals-empty {
  margin-top: clamp(1rem, 2vw, 1.4rem);
  opacity: 0.7;
  font-style: italic;
}

.goal-card {
  list-style: none;
  background: var(--card-dark);
  border-radius: 14px;
  padding: clamp(0.5rem, 1vw, 0.75rem);
  border: 1px solid rgba(255, 255, 255, 0.08);
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
  position: relative;
  overflow: hidden;
  transition: border var(--transition), box-shadow var(--transition), transform var(--transition);
}

.goal-card--locked {
  display: none;
}

.goal-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(120deg, rgba(76, 141, 255, 0.16), rgba(110, 90, 255, 0.08));
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition);
}

.goal-card:hover::before {
  opacity: 1;
}

.goal-card__header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 0.8rem;
}

.goal-card__title {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(0.95rem, 1.6vw, 1.15rem);
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.goal-card__description {
  margin: 0;
  opacity: 0.8;
  line-height: 1.45;
}

.goal-card__reward {
  margin: 0;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--accent-strong);
}

.goal-card--completed {
  border-color: rgba(120, 220, 255, 0.5);
  box-shadow: 0 16px 40px rgba(90, 200, 255, 0.25);
}

body.theme-light .goal-card {
  background: var(--card-light);
  border-color: rgba(12, 16, 32, 0.08);
}

body.theme-light .goal-card__reward {
  color: #2760c7;
}

body.theme-neon .goal-card {
  background: var(--card-neon);
  border-color: rgba(110, 130, 255, 0.22);
}

body.theme-neon .goal-card__reward {
  color: #9ffaff;
}

.option-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.8rem;
  align-items: center;
}

.option-row input[type="range"] {
  flex: 1 1 140px;
  min-width: 140px;
  accent-color: var(--accent);
  cursor: pointer;
}

.option-row input[type="range"]:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

select, button {
  font-family: inherit;
}

select {
  padding: 0.5rem 0.8rem;
  border-radius: 0.8rem;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(0,0,0,0.15);
  color: inherit;
  min-width: 160px;
}

body.theme-light select {
  border-color: rgba(12,16,32,0.12);
  background: rgba(255,255,255,0.9);
}

.primary {
  background: var(--accent);
  color: #05070c;
}

.danger {
  background: var(--danger);
  color: #fff;
}

.option-note {
  margin: 0;
  opacity: 0.7;
  font-size: 0.9rem;
}

.toast {
  position: fixed;
  bottom: 1.5rem;
  right: 1.5rem;
  background: rgba(12,16,32,0.9);
  color: #fff;
  padding: 0.75rem 1.2rem;
  border-radius: 999px;
  box-shadow: 0 12px 24px rgba(0,0,0,0.22);
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.25s ease, transform 0.25s ease;
  pointer-events: none;
  font-size: 0.9rem;
}

.toast.visible {
  opacity: 1;
  transform: translateY(0);
}

body.devkit-open {
  overflow: hidden;
}

.devkit-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(1rem, 4vw, 2.5rem);
  background: rgba(5, 8, 16, 0.82);
  backdrop-filter: blur(10px);
  z-index: 80;
}

.sound-designer-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: clamp(1rem, 6vw, 3rem) clamp(0.75rem, 4vw, 2.5rem);
  background: rgba(5, 8, 16, 0.86);
  backdrop-filter: blur(12px);
  z-index: 90;
  overflow-y: auto;
}

.sound-designer-overlay[hidden] {
  display: none !important;
}

.sound-designer-panel {
  background: rgba(12, 16, 32, 0.96);
  color: #f4f7ff;
  max-width: min(1024px, 96vw);
  width: 100%;
  border-radius: 20px;
  box-shadow: 0 24px 60px rgba(0, 0, 0, 0.55);
  display: flex;
  flex-direction: column;
  gap: 1.2rem;
  padding: clamp(1.2rem, 2vw, 1.8rem);
  max-height: min(720px, 92vh);
  overflow-y: auto;
  margin: 0 auto;
}

.sound-designer-panel__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
}

.sound-designer-panel__header h2 {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: clamp(1.1rem, 2.2vw, 1.4rem);
}

.sound-designer-panel__close {
  appearance: none;
  border: none;
  background: rgba(255, 255, 255, 0.08);
  color: inherit;
  font-size: 1.5rem;
  width: 2.4rem;
  height: 2.4rem;
  border-radius: 999px;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: background var(--transition), transform var(--transition);
}

.sound-designer-panel__close:hover,
.sound-designer-panel__close:focus-visible {
  background: rgba(255, 255, 255, 0.18);
  transform: scale(1.05);
}

.sound-designer-intro {
  margin: 0;
  opacity: 0.85;
  line-height: 1.6;
}

.sound-designer-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
  gap: clamp(1.2rem, 2vw, 1.8rem);
}

.sound-designer-form {
  display: flex;
  flex-direction: column;
  gap: 1.2rem;
  background: rgba(255, 255, 255, 0.04);
  border-radius: 16px;
  padding: clamp(1rem, 2vw, 1.4rem);
}

.sound-designer-fieldset {
  border: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.95rem;
}

.sound-designer-fieldset legend {
  font-weight: 600;
  margin-bottom: 0.4rem;
}

.sound-designer-field {
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
}

.sound-designer-field input[type='text'],
.sound-designer-field select {
  background: rgba(5, 8, 16, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 10px;
  padding: 0.6rem 0.75rem;
  color: inherit;
  font: inherit;
}

.sound-designer-field input[type='text']:focus-visible,
.sound-designer-field select:focus-visible {
  outline: 2px solid rgba(110, 190, 255, 0.6);
  outline-offset: 2px;
}

.sound-designer-field--range label {
  font-weight: 500;
}

.sound-designer-range {
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 0.8rem;
}

.sound-designer-range input[type='range'] {
  width: 100%;
}

.sound-designer-range output {
  min-width: 70px;
  text-align: right;
  font-variant-numeric: tabular-nums;
  opacity: 0.85;
}

.sound-designer-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
  justify-content: flex-end;
}

.sound-designer-button {
  appearance: none;
  border: 1px solid rgba(255, 255, 255, 0.16);
  background: rgba(12, 16, 32, 0.6);
  color: inherit;
  padding: 0.55rem 1rem;
  border-radius: 10px;
  font: inherit;
  cursor: pointer;
  transition: border var(--transition), background var(--transition), transform var(--transition);
}

.sound-designer-button:hover,
.sound-designer-button:focus-visible {
  border-color: rgba(110, 190, 255, 0.6);
  background: rgba(40, 60, 110, 0.55);
  transform: translateY(-1px);
}

.sound-designer-presets {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 16px;
  padding: clamp(1rem, 2vw, 1.4rem);
  display: flex;
  flex-direction: column;
  gap: 0.9rem;
}

.sound-designer-presets__header {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
}

.sound-designer-presets__header h3 {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  font-size: 0.95rem;
}

.sound-designer-presets__subtitle {
  margin: 0;
  opacity: 0.75;
  font-size: 0.9rem;
}

.sound-designer-presets__list {
  display: grid;
  gap: 0.75rem;
}

.sound-designer-preset {
  background: rgba(5, 8, 16, 0.6);
  border-radius: 12px;
  padding: 0.85rem 1rem;
  border: 1px solid rgba(255, 255, 255, 0.08);
  display: grid;
  gap: 0.6rem;
}

.sound-designer-preset__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.8rem;
}

.sound-designer-preset__title {
  margin: 0;
  font-weight: 600;
}

.sound-designer-preset__assignment {
  margin: 0;
  font-size: 0.85rem;
  opacity: 0.8;
}

.sound-designer-preset__meta {
  margin: 0;
  font-size: 0.8rem;
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  opacity: 0.75;
}

.sound-designer-preset__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.sound-designer-preset__button {
  appearance: none;
  border: 1px solid rgba(110, 190, 255, 0.4);
  background: transparent;
  color: inherit;
  padding: 0.4rem 0.85rem;
  border-radius: 999px;
  cursor: pointer;
  font: inherit;
  font-size: 0.82rem;
  transition: background var(--transition), transform var(--transition);
}

.sound-designer-preset__actions select.sound-designer-preset__button {
  padding-right: 2rem;
  min-width: 140px;
  background: rgba(12, 16, 32, 0.55);
}

.sound-designer-preset__button:hover,
.sound-designer-preset__button:focus-visible {
  background: rgba(110, 190, 255, 0.22);
  transform: translateY(-1px);
}

.sound-designer-empty {
  margin: 0;
  opacity: 0.7;
  font-style: italic;
}

.sound-designer-presets__list:empty::after {
  content: 'Aucun effet enregistré pour le moment.';
  display: block;
  font-style: italic;
  opacity: 0.7;
}

body.theme-light .sound-designer-panel {
  background: rgba(246, 247, 251, 0.98);
  color: var(--fg-light);
}

body.theme-light .sound-designer-form,
body.theme-light .sound-designer-presets,
body.theme-light .sound-designer-preset {
  background: rgba(255, 255, 255, 0.9);
  color: inherit;
}

body.theme-light .sound-designer-field input[type='text'],
body.theme-light .sound-designer-field select {
  background: rgba(255, 255, 255, 0.85);
  border-color: rgba(12, 16, 32, 0.12);
  color: inherit;
}

body.theme-light .sound-designer-preset__actions select.sound-designer-preset__button {
  background: rgba(255, 255, 255, 0.85);
  border-color: rgba(12, 16, 32, 0.18);
}

body.theme-neon .sound-designer-panel {
  background: rgba(20, 20, 60, 0.92);
  color: var(--fg-neon);
}

body.sound-designer-open {
  overflow: hidden;
}

@media (max-width: 980px) {
  .sound-designer-grid {
    grid-template-columns: 1fr;
  }

  .sound-designer-actions {
    justify-content: stretch;
  }

  .sound-designer-actions > * {
    flex: 1 1 45%;
  }
}

.devkit-overlay[hidden] {
  display: none;
}

.devkit-panel {
  width: min(760px, 96vw);
  max-height: min(90vh, 860px);
  background: rgba(12, 16, 32, 0.92);
  border-radius: 1.25rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 26px 64px rgba(0, 0, 0, 0.5);
  padding: clamp(1.2rem, 2.6vw, 1.8rem);
  display: flex;
  flex-direction: column;
  gap: clamp(1rem, 2vw, 1.5rem);
  color: inherit;
  overflow-y: auto;
}

body.theme-light .devkit-overlay {
  background: rgba(12, 18, 32, 0.45);
}

body.theme-neon .devkit-overlay {
  background: rgba(10, 10, 40, 0.72);
}

body.theme-light .devkit-panel {
  background: rgba(246, 247, 251, 0.96);
  border-color: rgba(12, 16, 32, 0.14);
  box-shadow: 0 24px 60px rgba(10, 12, 24, 0.28);
}

body.theme-neon .devkit-panel {
  background: rgba(14, 16, 48, 0.9);
  border-color: rgba(120, 140, 255, 0.28);
  box-shadow: 0 30px 70px rgba(30, 40, 120, 0.4);
}

.devkit-panel__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
}

.devkit-panel__close {
  width: 2.4rem;
  height: 2.4rem;
  border-radius: 50%;
  border: 1px solid transparent;
  background: rgba(255, 255, 255, 0.06);
  color: inherit;
  font-size: 1.4rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background var(--transition), transform var(--transition), border-color var(--transition);
}

.devkit-panel__close:hover,
.devkit-panel__close:focus-visible {
  background: rgba(255, 255, 255, 0.12);
  transform: scale(1.05);
}

body.theme-light .devkit-panel__close {
  background: rgba(12, 16, 32, 0.08);
}

body.theme-light .devkit-panel__close:hover,
body.theme-light .devkit-panel__close:focus-visible {
  background: rgba(12, 16, 32, 0.16);
}

body.theme-neon .devkit-panel__close {
  background: rgba(120, 140, 255, 0.18);
}

body.theme-neon .devkit-panel__close:hover,
body.theme-neon .devkit-panel__close:focus-visible {
  background: rgba(140, 160, 255, 0.28);
}

.devkit-panel__intro {
  margin: 0;
  font-size: 0.92rem;
  opacity: 0.8;
}

.devkit-grid {
  display: grid;
  gap: clamp(1rem, 2vw, 1.5rem);
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.devkit-section {
  border-radius: 1rem;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: rgba(255, 255, 255, 0.05);
  padding: clamp(0.9rem, 1.8vw, 1.3rem);
  display: flex;
  flex-direction: column;
  gap: 0.85rem;
}

body.theme-light .devkit-section {
  border-color: rgba(12, 16, 32, 0.12);
  background: rgba(12, 16, 32, 0.06);
}

body.theme-neon .devkit-section {
  border-color: rgba(120, 140, 255, 0.26);
  background: rgba(100, 120, 255, 0.12);
}

.devkit-form {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.devkit-form__controls {
  display: flex;
  gap: 0.65rem;
  flex-wrap: wrap;
}

.devkit-form__controls input {
  flex: 1 1 160px;
  padding: 0.55rem 0.75rem;
  border-radius: 0.8rem;
  border: 1px solid rgba(255, 255, 255, 0.18);
  background: rgba(0, 0, 0, 0.18);
  color: inherit;
}

body.theme-light .devkit-form__controls input {
  border-color: rgba(12, 16, 32, 0.18);
  background: rgba(255, 255, 255, 0.88);
  color: inherit;
}

body.theme-neon .devkit-form__controls input {
  border-color: rgba(140, 160, 255, 0.32);
  background: rgba(20, 24, 60, 0.6);
  color: inherit;
}

.devkit-status-row {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  flex-wrap: wrap;
  font-size: 0.9rem;
}

.devkit-status-row strong {
  font-family: 'Orbitron', monospace;
  font-size: 0.95rem;
}

.devkit-link {
  background: none;
  border: none;
  color: var(--accent-strong);
  cursor: pointer;
  padding: 0;
  font-size: 0.9rem;
  text-decoration: underline;
}

.devkit-action,
.devkit-toggle {
  padding: 0.65rem 0.9rem;
  border-radius: 0.9rem;
  border: 1px solid rgba(255, 255, 255, 0.16);
  background: rgba(255, 255, 255, 0.04);
  color: inherit;
  cursor: pointer;
  transition: background var(--transition), transform var(--transition), border-color var(--transition), box-shadow var(--transition);
}

.devkit-action:hover,
.devkit-action:focus-visible,
.devkit-toggle:hover,
.devkit-toggle:focus-visible {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-1px);
}

.devkit-toggle[data-active="true"] {
  border-color: var(--accent-strong);
  background: linear-gradient(135deg, rgba(76, 141, 255, 0.28), rgba(110, 189, 255, 0.2));
  box-shadow: 0 0 18px rgba(110, 189, 255, 0.25);
}

.devkit-note {
  margin: 0;
  font-size: 0.85rem;
  opacity: 0.75;
}

.devkit-panel__footer {
  display: flex;
  justify-content: flex-end;
  font-size: 0.85rem;
  opacity: 0.7;
}

.devkit-panel__footer kbd {
  padding: 0.2rem 0.45rem;
  border-radius: 0.4rem;
  background: rgba(255, 255, 255, 0.15);
  font-family: 'Orbitron', monospace;
  font-size: 0.85rem;
}

body.theme-light .devkit-panel__footer kbd {
  background: rgba(12, 16, 32, 0.15);
}

body.theme-neon .devkit-panel__footer kbd {
  background: rgba(140, 160, 255, 0.25);
}

@media (max-width: 640px) {
  .app-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .nav-menu {
    width: 100%;
    justify-content: space-between;
  }

  .devkit-panel {
    width: 100%;
    max-height: 92vh;
    padding: 1.2rem;
  }

  .devkit-grid {
    grid-template-columns: 1fr;
  }

  .devkit-form__controls {
    flex-direction: column;
  }

  .devkit-form__controls input {
    width: 100%;
  }

  .devkit-panel__footer {
    justify-content: center;
  }
}

.page--metaux {
  --metaux-vertical-space: clamp(3.5rem, 18vh, 12rem);
  display: none;
  padding: clamp(1.2rem, 3vw, 2.6rem) clamp(1rem, 3.5vw, 3rem);
  position: relative;
  min-height: 100vh;
}

.page--metaux.active {
  display: flex;
  flex-direction: column;
  gap: clamp(1.5rem, 3vw, 2.4rem);
}

.metaux-exit-button {
  position: absolute;
  top: clamp(0.8rem, 2vw, 1.6rem);
  right: clamp(0.8rem, 2vw, 1.6rem);
  width: clamp(2.25rem, 4vw, 2.75rem);
  height: clamp(2.25rem, 4vw, 2.75rem);
  border-radius: 50%;
  border: 1px solid rgba(255, 255, 255, 0.28);
  background: linear-gradient(160deg, rgba(18, 22, 42, 0.88), rgba(8, 10, 22, 0.72));
  color: rgba(255, 255, 255, 0.85);
  font-size: clamp(1.2rem, 2vw, 1.4rem);
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow:
    0 12px 24px rgba(0, 0, 0, 0.32),
    0 0 0 1px rgba(255, 255, 255, 0.08);
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
  z-index: 4;
}

.metaux-exit-button:hover,
.metaux-exit-button:focus {
  transform: scale(1.05);
  border-color: rgba(255, 255, 255, 0.45);
  box-shadow:
    0 14px 26px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.14);
}

.metaux-exit-button:active {
  transform: scale(0.94);
}

.metaux-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(1rem, 2vw, 1.8rem);
  flex-wrap: wrap;
}

.metaux-header__brand {
  min-width: max-content;
}

.metaux-header__stats {
  display: flex;
  gap: clamp(0.6rem, 1.5vw, 1.2rem);
  flex-wrap: wrap;
}

.metaux-stat {
  padding: 0.6rem 1rem;
  border-radius: 16px;
  background: linear-gradient(160deg, rgba(18, 22, 42, 0.9), rgba(8, 10, 22, 0.7));
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow:
    0 14px 28px rgba(0, 0, 0, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.08),
    inset 0 0 32px rgba(255, 255, 255, 0.04);
  min-width: 140px;
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.72rem;
}

.metaux-stat__label {
  color: rgba(255, 255, 255, 0.7);
}

.metaux-stat__value {
  font-size: 1.2rem;
  font-weight: 600;
  letter-spacing: 0.06em;
}

.metaux-content {
  display: grid;
  gap: clamp(1.5rem, 3vw, 2.5rem);
  grid-template-columns: minmax(0, 1fr);
  justify-items: center;
}

.metaux-board-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  width: min(100%, 1280px);
  position: relative;
}

.metaux-timer {
  position: absolute;
  top: clamp(0.6rem, 1.8vw, 1.2rem);
  left: clamp(0.6rem, 1.8vw, 1.2rem);
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  padding: clamp(0.5rem, 1vw, 0.8rem) clamp(0.8rem, 2vw, 1.1rem);
  border-radius: 18px;
  background: linear-gradient(165deg, rgba(10, 14, 28, 0.92), rgba(5, 7, 18, 0.78));
  border: 1px solid rgba(255, 255, 255, 0.22);
  box-shadow:
    0 18px 32px rgba(0, 0, 0, 0.42),
    0 0 0 1px rgba(255, 255, 255, 0.12),
    inset 0 0 28px rgba(255, 255, 255, 0.08);
  min-width: clamp(150px, 18vw, 210px);
  pointer-events: none;
  z-index: 3;
}

.metaux-timer__label {
  margin: 0;
  font-size: 0.78rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.68);
}

.metaux-timer__max {
  font-size: 0.68rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.58);
}

.metaux-timer__bar {
  width: 100%;
  height: 6px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.12);
  overflow: hidden;
  position: relative;
}

.metaux-timer__bar-fill {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(120deg, #f8b93a, #ff6c3a);
  transform-origin: left center;
  transition: transform 0.18s ease, width 0.18s ease;
}

.metaux-timer__value {
  font-size: clamp(1.3rem, 2.6vw, 1.7rem);
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

.metaux-board {
  --board-bg: linear-gradient(160deg, rgba(14, 18, 34, 0.9), rgba(8, 10, 22, 0.78));
  --metaux-pop-duration: 220ms;
  --metaux-pop-scale: 1.18;
  --metaux-pop-glow-opacity: 0.8;
  display: grid;
  grid-template-columns: repeat(var(--metaux-cols, 16), minmax(0, 1fr));
  gap: clamp(0.18rem, 0.45vw, 0.34rem);
  width: min(
    90vw,
    1280px,
    calc((100vh - var(--metaux-vertical-space)) * var(--metaux-cols, 16) / var(--metaux-rows, 9))
  );
  max-height: calc(100vh - var(--metaux-vertical-space));
  padding: clamp(0.6rem, 1.6vw, 1.1rem);
  border-radius: 28px;
  border: 1px solid rgba(255, 255, 255, 0.18);
  background: var(--board-bg);
  box-shadow:
    0 24px 48px rgba(0, 0, 0, 0.45),
    0 0 0 1px rgba(255, 255, 255, 0.1),
    inset 0 0 48px rgba(255, 255, 255, 0.05);
  position: relative;
  overflow: hidden;
  margin: 0 auto;
}

.metaux-end-screen {
  position: absolute;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: clamp(1.2rem, 4vw, 2.2rem);
  background: rgba(6, 8, 20, 0.82);
  backdrop-filter: blur(8px);
  z-index: 4;
}

.metaux-end-screen:not([hidden]) {
  display: flex;
}

.metaux-end-screen__panel {
  width: min(90vw, 420px);
  border-radius: 26px;
  background: linear-gradient(175deg, rgba(16, 20, 36, 0.95), rgba(8, 10, 22, 0.82));
  border: 1px solid rgba(255, 255, 255, 0.16);
  box-shadow:
    0 28px 46px rgba(0, 0, 0, 0.5),
    0 0 0 1px rgba(255, 255, 255, 0.12),
    inset 0 0 42px rgba(255, 255, 255, 0.04);
  padding: clamp(1.4rem, 3vw, 2.1rem);
  display: flex;
  flex-direction: column;
  gap: 1.1rem;
  text-align: center;
}

.metaux-end-screen__panel h2 {
  margin: 0;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: clamp(1.2rem, 2.8vw, 1.6rem);
}

.metaux-end-screen__summary {
  margin: 0;
  display: grid;
  gap: 0.8rem;
}

.metaux-end-screen__summary-item {
  display: flex;
  justify-content: space-between;
  gap: 0.6rem;
  font-size: 0.95rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.75);
}

.metaux-end-screen__summary-item dd {
  margin: 0;
  font-weight: 600;
  color: #ffffff;
}

.metaux-end-screen__summary-item dt {
  margin: 0;
}

.metaux-end-screen__colors {
  text-align: left;
}

.metaux-end-screen__colors h3 {
  margin: 0 0 0.6rem;
  font-size: 0.92rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.72);
}

.metaux-end-screen__colors ul {
  margin: 0;
  padding: 0;
  list-style: none;
  display: grid;
  gap: 0.45rem;
}

.metaux-end-screen__color-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.6rem;
  padding: 0.35rem 0.4rem;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.04);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
}

.metaux-end-screen__color-label {
  display: flex;
  align-items: center;
  gap: 0.45rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.metaux-end-screen__color-label::before {
  content: '';
  width: 0.8rem;
  height: 0.8rem;
  border-radius: 50%;
  background: var(--match-color, rgba(255, 255, 255, 0.4));
  box-shadow:
    0 0 0 1px rgba(255, 255, 255, 0.4),
    0 6px 12px rgba(0, 0, 0, 0.4);
}

.metaux-end-screen__color-value {
  font-weight: 600;
  letter-spacing: 0.08em;
}

.metaux-end-screen__actions {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.8rem;
  margin-top: 0.6rem;
}

.metaux-end-screen__button {
  padding: 0.6rem 1.6rem;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.26);
  background: linear-gradient(150deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0.06));
  color: #f7f9ff;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
  cursor: pointer;
}

.metaux-end-screen__button:hover,
.metaux-end-screen__button:focus {
  transform: translateY(-1px);
  box-shadow:
    0 18px 28px rgba(0, 0, 0, 0.32),
    0 0 0 1px rgba(255, 255, 255, 0.24);
  border-color: rgba(255, 255, 255, 0.4);
}

.metaux-end-screen__button:active {
  transform: translateY(1px);
  box-shadow: none;
}

.metaux-end-screen__button--ghost {
  background: rgba(255, 255, 255, 0.06);
  border-color: rgba(255, 255, 255, 0.32);
  color: rgba(255, 255, 255, 0.86);
}

.metaux-board::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.12), transparent 60%);
  pointer-events: none;
}

@keyframes metaux-tile-pop {
  0% {
    transform: scale(1);
    opacity: 1;
    box-shadow:
      0 14px 26px rgba(0, 0, 0, 0.32),
      0 0 0 1px rgba(255, 255, 255, 0.08),
      0 0 26px rgba(255, 255, 255, 0.12);
  }
  60% {
    transform: scale(var(--metaux-pop-scale, 1.18));
    opacity: 1;
    box-shadow:
      0 20px 40px rgba(0, 0, 0, 0.4),
      0 0 0 1px rgba(255, 255, 255, 0.2),
      0 0 48px var(--tile-color);
  }
  100% {
    transform: scale(0.4);
    opacity: 0;
    box-shadow:
      0 8px 18px rgba(0, 0, 0, 0.3),
      0 0 0 1px rgba(255, 255, 255, 0),
      0 0 36px rgba(255, 255, 255, 0);
  }
}

@keyframes metaux-tile-pop-glow {
  0% {
    opacity: 0.6;
    transform: scale(1);
  }
  50% {
    opacity: var(--metaux-pop-glow-opacity, 0.8);
    transform: scale(calc(var(--metaux-pop-scale, 1.18) * 1.1));
  }
  100% {
    opacity: 0;
    transform: scale(calc(var(--metaux-pop-scale, 1.18) * 1.35));
  }
}

.metaux-tile {
  --tile-color: rgba(255, 255, 255, 0.55);
  position: relative;
  border-radius: 10px;
  background: linear-gradient(155deg, rgba(20, 24, 42, 0.92), rgba(10, 12, 28, 0.7));
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow:
    0 14px 26px rgba(0, 0, 0, 0.32),
    0 0 0 1px rgba(255, 255, 255, 0.08),
    0 0 26px rgba(255, 255, 255, 0.12);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #f8f9ff;
  font-family: 'Orbitron', 'Inter', sans-serif;
  font-size: clamp(0.38rem, 0.8vw, 0.62rem);
  letter-spacing: 0.14em;
  text-transform: uppercase;
  overflow: hidden;
  aspect-ratio: 1 / 1;
  user-select: none;
  -webkit-user-select: none;
  cursor: grab;
  touch-action: none;
  transition: transform 0.22s ease, box-shadow 0.22s ease, border-color 0.22s ease, opacity 0.18s ease;
}

.metaux-tile::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(140deg, rgba(255, 255, 255, 0.16), rgba(255, 255, 255, 0));
  pointer-events: none;
}

.metaux-tile::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: linear-gradient(150deg, var(--tile-color), transparent 70%);
  opacity: 0.6;
  pointer-events: none;
  mix-blend-mode: screen;
}

.metaux-tile span {
  position: relative;
  z-index: 1;
}

.metaux-tile.is-selected,
.metaux-tile.is-target {
  transform: translateY(-3px) scale(1.04);
  box-shadow:
    0 20px 36px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.12),
    0 0 42px var(--tile-color);
  border-color: rgba(255, 255, 255, 0.32);
}

.metaux-tile.is-target {
  cursor: grabbing;
}

.metaux-tile.is-clearing {
  animation: metaux-tile-pop var(--metaux-pop-duration, 220ms) cubic-bezier(0.3, 0.8, 0.4, 1) forwards;
  transition: none;
}

.metaux-tile.is-clearing::after {
  animation: metaux-tile-pop-glow var(--metaux-pop-duration, 220ms) ease-out forwards;
  opacity: var(--metaux-pop-glow-opacity, 0.8);
}

.metaux-tile.is-clearing span {
  animation: metaux-tile-fade-out var(--metaux-pop-duration, 220ms) ease forwards;
}

@keyframes metaux-tile-fade-out {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

.metaux-tile.is-empty {
  opacity: 0;
  pointer-events: none;
  box-shadow: none;
  border-color: transparent;
}

.metaux-message {
  margin: 0;
  min-height: 1.5rem;
  font-size: 0.85rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.72);
  text-align: center;
}

.metaux-sidebar {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: clamp(1rem, 2.6vw, 1.8rem);
  border-radius: 24px;
  background: linear-gradient(170deg, rgba(16, 19, 34, 0.92), rgba(8, 10, 22, 0.75));
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow:
    0 20px 38px rgba(0, 0, 0, 0.38),
    0 0 0 1px rgba(255, 255, 255, 0.08),
    inset 0 0 36px rgba(255, 255, 255, 0.04);
}

.metaux-sidebar__title {
  margin: 0;
  font-size: clamp(1.1rem, 2.4vw, 1.4rem);
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.metaux-sidebar__intro {
  margin: 0;
  color: rgba(255, 255, 255, 0.78);
  line-height: 1.5;
}

.metaux-sidebar__stats {
  margin: 0;
  display: grid;
  gap: 0.8rem;
}

.metaux-sidebar__stat {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  font-size: 0.95rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.8);
}

.metaux-sidebar__stat dt {
  margin: 0;
}

.metaux-sidebar__stat dd {
  margin: 0;
  font-weight: 600;
}

.metaux-reshuffle-button {
  align-self: flex-start;
  padding: 0.6rem 1.4rem;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.24);
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0.05));
  color: #f8f9ff;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
}

.metaux-reshuffle-button:hover,
.metaux-reshuffle-button:focus {
  transform: translateY(-2px);
  box-shadow: 0 16px 30px rgba(0, 0, 0, 0.32);
  border-color: rgba(255, 255, 255, 0.38);
  outline: none;
}

.metaux-reshuffle-button:active {
  transform: translateY(0);
}
